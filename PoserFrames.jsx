#target photoshop


// Settings

var borderThickness = 4; // Border width in %
var offset_factor = 1; // How much offset is allowed, where 1 is maximun
var feather_factor = 1200; // How much feathering of the border you like. The lower value, the more feathering.

// Initial

app.preferences.rulerUnits = Units.PIXELS;
app.displayDialogs.NO;

var doc_height = app.activeDocument.height;
var doc_width = app.activeDocument.width;
var ratio = doc_height / doc_width;

if (ratio > 1) {
	var feather = doc_width / feather_factor;
} else {
	var feather = doc_height / feather_factor;
}

var frameSquare = [];
var frame67 = [];
var frame645 = [];
var frame35mm = [];


// Frames

frame35mm[0] = "PointKind.CORNERPOINT 18.9679256708418,34.8394812510455 18.9679256708418,34.8394812510455 18.9679256708418,34.8394812510455 PathPoint;PointKind.SMOOTHPOINT 26.9118187123548,19.1859462551677 32.0070858674971,15.0385900371828 21.2912848818693,23.7608498314667 PathPoint;PointKind.SMOOTHPOINT 47.408856325806,13.00335284025 59.998737605741,12.6257155526793 41.2510552624345,13.1880579410581 PathPoint;PointKind.CORNERPOINT 107.239788605819,13.2756421284747 107.239788605819,13.2756421284747 107.239788605819,13.2756421284747 PathPoint;PointKind.SMOOTHPOINT 168.645219103727,13.5550969242842 174.567016172159,13.5392968157094 155.571124035322,13.5899802745934 PathPoint;PointKind.SMOOTHPOINT 196.986187025838,13.6840760608116 202.134204228149,14.125896242772 191.838169823527,13.2422558788513 PathPoint;PointKind.SMOOTHPOINT 226.908793361049,12.2512844515438 230.994472432269,12.769987077783 222.823114289829,11.7325818253045 PathPoint;PointKind.SMOOTHPOINT 252.10076484737,12.3659325729015 261.272704402351,13.3817419707681 242.928825292389,11.3501231750348 PathPoint;PointKind.SMOOTHPOINT 335.549170395809,12.745704474899 342.721105326192,12.6492307435426 328.377235465426,12.8421782062554 PathPoint;PointKind.SMOOTHPOINT 379.642260692075,11.3774024338949 393.360528122877,10.7999889067909 365.923993261273,11.9548159609989 PathPoint;PointKind.CORNERPOINT 475.693792178878,10.2455621431911 475.693792178878,10.2455621431911 475.693792178878,10.2455621431911 PathPoint;PointKind.SMOOTHPOINT 598.511793369898,9.2355354814299 603.131480931366,9.09279782038905 561.975348329063,10.3644271301585 PathPoint;PointKind.SMOOTHPOINT 752.81975891882,8.36881897136587 759.402089443269,9.43821681197794 746.669430810688,7.3696063712903 PathPoint;PointKind.CORNERPOINT 766.983102684672,10.0022447930098 766.983102684672,10.0022447930098 766.983102684672,10.0022447930098 PathPoint;PointKind.CORNERPOINT 784.302583081518,10.0810653764432 784.302583081518,10.0810653764432 784.302583081518,10.0810653764432 PathPoint;PointKind.SMOOTHPOINT 818.948684070413,8.66977028992994 827.577246542002,8.80260479752051 806.837169958278,8.48331663457787 PathPoint;PointKind.SMOOTHPOINT 845.71515377463,8.79158391887256 851.95480613654,9.92683886442588 840.339629521588,7.81355018570167 PathPoint;PointKind.SMOOTHPOINT 858.303999322586,10.4178442329316 858.84468935421,10.3913954780861 856.614765518653,10.5004759223356 PathPoint;PointKind.SMOOTHPOINT 870.907125260951,8.90623204023028 875.950671794287,7.84988641870536 866.5997119596,9.80839823437674 PathPoint;PointKind.CORNERPOINT 1020.48445596098,9.58695526079192 1020.48445596098,9.58695526079192 1020.48445596098,9.58695526079192 PathPoint;PointKind.SMOOTHPOINT 1247.22647972828,7.48091584625121 1252.98689050997,7.75236930494673 1238.58891429199,7.07387942102847 PathPoint;PointKind.SMOOTHPOINT 1255.09183062255,9.0856796375557 1263.8934651278,8.81442307790644 1250.64438735479,9.22274487916863 PathPoint;PointKind.CORNERPOINT 1264.54596012513,7.55973642968466 1264.54596012513,7.55973642968466 1264.54596012513,7.55973642968466 PathPoint;PointKind.CORNERPOINT 1343.27087101988,7.91801180892763 1343.27087101988,7.91801180892763 1343.27087101988,7.91801180892763 PathPoint;PointKind.SMOOTHPOINT 1351.13622191415,9.52277560023209 1355.13939196546,10.1518294304163 1347.13305186285,8.89372177004785 PathPoint;PointKind.CORNERPOINT 1363.73934785252,8.01116340753078 1363.73934785252,8.01116340753078 1363.73934785252,8.01116340753078 PathPoint;PointKind.CORNERPOINT 1502.29519102728,8.64172807499838 1502.29519102728,8.64172807499838 1502.29519102728,8.64172807499838 PathPoint;PointKind.CORNERPOINT 1681.79512806253,7.8896596862921 1681.79512806253,7.8896596862921 1681.79512806253,7.8896596862921 PathPoint;PointKind.CORNERPOINT 1689.6604789568,9.49442347759662 1689.6604789568,9.49442347759662 1689.6604789568,9.49442347759662 PathPoint;PointKind.CORNERPOINT 1699.11460845937,7.96848026972555 1699.11460845937,7.96848026972555 1699.11460845937,7.96848026972555 PathPoint;PointKind.CORNERPOINT 1889.63603301988,7.26657043411329 1889.63603301988,7.26657043411329 1889.63603301988,7.26657043411329 PathPoint;PointKind.CORNERPOINT 2229.73478828042,7.24538381906263 2229.73478828042,7.24538381906263 2229.73478828042,7.24538381906263 PathPoint;PointKind.SMOOTHPOINT 2242.32363382838,8.87164413312172 2246.78403587079,8.95981639111629 2235.20813267738,8.73098645310059 PathPoint;PointKind.SMOOTHPOINT 2254.92675976674,7.36003194042038 2264.66233841506,7.96001478149783 2245.19118111843,6.76004909934294 PathPoint;PointKind.CORNERPOINT 2500.55562195358,6.9089148702782 2500.55562195358,6.9089148702782 2500.55562195358,6.9089148702782 PathPoint;PointKind.CORNERPOINT 2514.71896571943,8.5423406919221 2514.71896571943,8.5423406919221 2514.71896571943,8.5423406919221 PathPoint;PointKind.CORNERPOINT 2525.7475934399,7.02356299163596 2525.7475934399,7.02356299163596 2525.7475934399,7.02356299163596 PathPoint;PointKind.CORNERPOINT 2535.18744255207,8.63549229052528 2535.18744255207,8.63549229052528 2535.18744255207,8.63549229052528 PathPoint;PointKind.CORNERPOINT 2552.51406314412,7.14537662057855 2552.51406314412,7.14537662057855 2552.51406314412,7.14537662057855 PathPoint;PointKind.CORNERPOINT 2727.28336533047,7.94074796249792 2727.28336533047,7.94074796249792 2727.28336533047,7.94074796249792 PathPoint;PointKind.CORNERPOINT 3237.43506831888,7.12449991323181 3237.43506831888,7.12449991323181 3237.43506831888,7.12449991323181 PathPoint;PointKind.CORNERPOINT 3520.8518877352,6.84535502512623 3520.8518877352,6.84535502512623 3520.8518877352,6.84535502512623 PathPoint;PointKind.SMOOTHPOINT 3741.28163824051,7.8485260870065 3757.62643885859,7.79526429278052 3659.09220250074,8.11635173482 PathPoint;PointKind.SMOOTHPOINT 3941.24291191319,8.75854555028359 3946.84575047953,8.36892096699592 3935.64007334684,9.14817013357127 PathPoint;PointKind.SMOOTHPOINT 4064.053772909,9.31745514190261 4075.94325188678,8.74806226227432 4052.16429393123,9.88684802153093 PathPoint;PointKind.SMOOTHPOINT 4190.01363034061,9.89069574869133 4203.70894205043,9.85251075780673 4176.31831863079,9.92888073957593 PathPoint;PointKind.SMOOTHPOINT 4248.27720459793,8.58688327595093 4253.65975452683,8.84999314224353 4242.89465466903,8.3237734096583 PathPoint;PointKind.SMOOTHPOINT 4257.7170537101,10.1988125748403 4262.82878222095,10.5056343559417 4252.60532519924,9.89199079373886 PathPoint;PointKind.SMOOTHPOINT 4273.46917608425,8.70153139730869 4282.53572669117,8.54830632337448 4264.40262547733,8.85475647124287 PathPoint;PointKind.SMOOTHPOINT 4473.43044975693,9.61155086058578 4459.97807784187,9.34734206874574 4457.34625084753,9.29565216343417 PathPoint;PointKind.SMOOTHPOINT 4793.05358798963,11.0661489003122 4939.56560294401,10.5741307715189 4748.8832488903,11.2144821793172 PathPoint;PointKind.SMOOTHPOINT 5292.16952306237,13.3376148047125 5292.16952306237,13.3376148047125 5292.11306374838,15.9194433449579 PathPoint;PointKind.SMOOTHPOINT 5342.55346603501,13.566911047428 5351.12241674665,13.7342040401585 5333.98451532337,13.3996180546974 PathPoint;PointKind.SMOOTHPOINT 5370.88729376192,15.2648264373356 5373.03019536576,15.6112532804227 5368.74439215808,14.9183995942486 PathPoint;PointKind.SMOOTHPOINT 5380.31286248368,20.0146282429854 5385.41840951269,26.1846254176767 5375.20731545467,13.8446310682941 PathPoint;PointKind.SMOOTHPOINT 5384.96495518533,35.7254872995421 5385.71037308338,43.7074142667821 5384.55468575464,31.332326575649 PathPoint;PointKind.SMOOTHPOINT 5386.36094852312,74.9560591416321 5384.09753907786,89.618917722076 5386.71750090209,72.6462352959502 PathPoint;PointKind.SMOOTHPOINT 5386.16816325262,117.317337982898 5386.77934650068,123.573113663513 5385.55698000457,111.061562302282 PathPoint;PointKind.SMOOTHPOINT 5386.07534071497,137.71350927684 5384.62339948646,147.403854749621 5386.86328816639,132.4546992998 PathPoint;PointKind.SMOOTHPOINT 5387.49275463839,172.23727235879 5387.87711656613,184.867334721043 5387.17011018828,161.635234978258 PathPoint;PointKind.SMOOTHPOINT 5388.32467255509,335.413808217916 5388.30081746284,334.310525605357 5388.22762475453,330.925410108489 PathPoint;PointKind.CORNERPOINT 5390.38835931991,573.906449746877 5390.38835931991,573.906449746877 5390.38835931991,573.906449746877 PathPoint;PointKind.SMOOTHPOINT 5390.08133092614,641.370708642226 5387.74025563861,647.629392082092 5392.42240621368,635.112025202359 PathPoint;PointKind.SMOOTHPOINT 5390.01706916931,655.491134922647 5391.06092668885,660.376032039859 5388.97321164978,650.606237805436 PathPoint;PointKind.SMOOTHPOINT 5389.95994760768,668.042624949689 5389.56614007911,672.585939082684 5390.35375513626,663.499310816694 PathPoint;PointKind.CORNERPOINT 5389.79572311799,704.128158777434 5389.79572311799,704.128158777434 5389.79572311799,704.128158777434 PathPoint;PointKind.CORNERPOINT 5388.14982294806,719.810355803651 5388.14982294806,719.810355803651 5388.14982294806,719.810355803651 PathPoint;PointKind.SMOOTHPOINT 5389.64577901872,737.075820098418 5390.47430304884,740.623662287857 5388.54899345418,732.379248898121 PathPoint;PointKind.SMOOTHPOINT 5389.53867609066,760.609863899121 5391.40069676058,766.260204912408 5386.11501853898,750.220702816106 PathPoint;PointKind.SMOOTHPOINT 5389.47441433382,774.730290179543 5390.11217962686,781.451974431613 5388.83664904079,768.008605927474 PathPoint;PointKind.CORNERPOINT 5389.11740457364,853.177102848553 5389.11740457364,853.177102848553 5389.11740457364,853.177102848553 PathPoint;PointKind.CORNERPOINT 5390.40629498338,915.941718491347 5390.40629498338,915.941718491347 5390.40629498338,915.941718491347 PathPoint;PointKind.CORNERPOINT 5391.35959621855,1052.44633804301 5391.35959621855,1052.44633804301 5391.35959621855,1052.44633804301 PathPoint;PointKind.CORNERPOINT 5392.43428077218,1162.27904128721 5392.43428077218,1162.27904128721 5392.43428077218,1162.27904128721 PathPoint;PointKind.SMOOTHPOINT 5391.93556298838,1703.47790098256 5391.93122209676,1708.1885523222 5392.2132616902,1402.12465943978 PathPoint;PointKind.SMOOTHPOINT 5391.92249939243,1717.65426176523 5392.4635912376,1721.22340610015 5391.24895847455,1713.2114582507 PathPoint;PointKind.SMOOTHPOINT 5391.91249780626,1728.5077889637 5391.84034639351,1806.80510174008 5391.91583915104,1724.88182646282 PathPoint;PointKind.SMOOTHPOINT 5391.68849675424,1971.58938313399 5391.68549042972,1974.85178815317 5391.76474902099,1888.84190317871 PathPoint;PointKind.SMOOTHPOINT 5391.67947489781,1981.37972663511 5390.77734281539,1985.76259626507 5392.33769059129,1978.18188717327 PathPoint;PointKind.SMOOTHPOINT 5391.67056960164,1991.04358119483 5391.5618572677,2109.01609606611 5391.67353874847,1987.82152068108 PathPoint;PointKind.SMOOTHPOINT 5391.34983910713,2339.09408899246 5391.34727818742,2341.87314935807 5391.45226010378,2227.94881125208 PathPoint;PointKind.SMOOTHPOINT 5391.34216993348,2347.41652739602 5392.87388459275,2354.54599893469 5390.76040862583,2344.7086792599 PathPoint;PointKind.SMOOTHPOINT 5391.32515365983,2365.88225730007 5391.17988749383,2523.52228127286 5391.33080183937,2359.75296248899 PathPoint;PointKind.SMOOTHPOINT 5390.96156857583,2760.43773388119 5390.9569832316,2765.41366044082 5391.0507471777,2663.66284593864 PathPoint;PointKind.SMOOTHPOINT 5390.94813273124,2775.01805166121 5390.25809162595,2780.51923776193 5391.53848921298,2770.31157715273 PathPoint;PointKind.SMOOTHPOINT 5390.93499874278,2789.270801032 5390.87223245246,2857.38356109041 5390.93925926091,2784.6473694423 PathPoint;PointKind.CORNERPOINT 5390.83521774839,2897.55119955606 5390.83521774839,2897.55119955606 5390.83521774839,2897.55119955606 PathPoint;PointKind.CORNERPOINT 5390.44250701219,2983.84269349197 5390.44250701219,2983.84269349197 5390.44250701219,2983.84269349197 PathPoint;PointKind.SMOOTHPOINT 5388.83230781827,2991.68020925128 5388.21922526114,2997.5545145619 5389.44539037541,2985.80590394066 PathPoint;PointKind.SMOOTHPOINT 5390.35682466974,3002.66992853253 5392.12725512789,3008.27724294387 5388.58639421159,2997.06261412119 PathPoint;PointKind.CORNERPOINT 5390.07121686159,3065.42737866774 5390.07121686159,3065.42737866774 5390.07121686159,3065.42737866774 PathPoint;PointKind.CORNERPOINT 5389.3357767556,3227.0278127659 5389.3357767556,3227.0278127659 5389.3357767556,3227.0278127659 PathPoint;PointKind.CORNERPOINT 5389.04302875225,3291.35419915449 5389.04302875225,3291.35419915449 5389.04302875225,3291.35419915449 PathPoint;PointKind.CORNERPOINT 5390.1534142819,3393.34222113179 5390.1534142819,3393.34222113179 5390.1534142819,3393.34222113179 PathPoint;PointKind.CORNERPOINT 5387.27534663282,3551.36093056639 5387.27534663282,3551.36093056639 5387.27534663282,3551.36093056639 PathPoint;PointKind.SMOOTHPOINT 5387.18252409517,3571.75710186034 5387.18037012969,3576.7352991485 5387.18529288019,3565.35794729784 PathPoint;PointKind.SMOOTHPOINT 5382.37334709904,3590.56284037814 5378.80072622624,3593.16773674068 5385.94158276658,3587.96114138965 PathPoint;PointKind.SMOOTHPOINT 5371.33043898817,3595.21949058519 5366.33007291218,3595.82233548429 5382.18589650232,3593.91075496656 PathPoint;PointKind.SMOOTHPOINT 5260.01905998972,3595.25891170059 5257.13217111755,3595.23894375083 5314.48815403603,3595.63566196064 PathPoint;PointKind.SMOOTHPOINT 5251.34283644347,3595.19749529039 5249.71717530659,3595.98711687966 5253.94523403857,3593.93344998702 PathPoint;PointKind.SMOOTHPOINT 5244.80536359025,3595.14946630539 5185.97125991276,3594.71082272792 5246.98310027334,3595.16570264027 PathPoint;PointKind.CORNERPOINT 5128.85771343232,3594.11600241712 5128.85771343232,3594.11600241712 5128.85771343232,3594.11600241712 PathPoint;PointKind.SMOOTHPOINT 4930.15119334364,3593.73551952344 4925.66018524097,3593.72692014906 5039.56443790499,3593.94502381087 PathPoint;PointKind.SMOOTHPOINT 4916.58125843491,3593.70953583605 4908.5723641997,3594.99389781901 4921.07741071834,3592.98850158427 PathPoint;PointKind.SMOOTHPOINT 4894.22053198902,3593.66671955655 4811.05924743781,3593.50748247578 4901.73705288478,3593.68111217748 PathPoint;PointKind.SMOOTHPOINT 4651.73188551958,3593.2024027246 4582.7400494817,3593.76605726335 4721.02270924023,3592.63630549446 PathPoint;PointKind.CORNERPOINT 4533.69024687278,3592.97637680343 4533.69024687278,3592.97637680343 4533.69024687278,3592.97637680343 PathPoint;PointKind.SMOOTHPOINT 4480.90327759913,3592.89434254385 4422.63407286419,3592.80378854667 4514.34103833104,3592.94630692031 PathPoint;PointKind.SMOOTHPOINT 4205.58546475774,3592.46648140245 4192.00521551788,3592.44537684376 4321.58197249351,3592.64674724753 PathPoint;PointKind.SMOOTHPOINT 4164.2748836473,3592.40228216956 4154.06670609822,3593.23701407817 4178.17339327604,3591.26578846993 PathPoint;PointKind.SMOOTHPOINT 4136.80984167558,3592.35959977249 4032.96712005928,3592.19822167299 4146.02467222345,3592.37392019686 PathPoint;PointKind.SMOOTHPOINT 3824.77433475343,3595.86693323047 3821.79671561939,3595.86230582366 3925.04975208594,3596.02276751548 PathPoint;PointKind.SMOOTHPOINT 3815.87008585849,3595.85309546946 3812.98029973147,3595.14118427677 3818.11457346664,3596.40603460747 PathPoint;PointKind.SMOOTHPOINT 3806.97016858622,3595.83926444007 3629.4868166901,3595.56344418442 3809.92652470492,3595.84385880281 PathPoint;PointKind.CORNERPOINT 3485.63542288465,3593.34764416126 3485.63542288465,3593.34764416126 3485.63542288465,3593.34764416126 PathPoint;PointKind.SMOOTHPOINT 3173.70662915393,3593.92052636357 3167.63233550865,3593.93168229015 3366.96192285887,3593.56559754491 PathPoint;PointKind.SMOOTHPOINT 3155.26407127047,3593.95439759761 3150.77429477682,3592.94199547277 3160.91880842996,3595.22948733175 PathPoint;PointKind.SMOOTHPOINT 3141.33605120077,3593.97997752153 2993.06847302085,3594.25228279897 3146.01795732577,3593.9713788261 PathPoint;PointKind.SMOOTHPOINT 2596.67625178978,3594.98028884792 2592.20424312265,3594.98850204986 2805.64081406492,3594.59650869986 PathPoint;PointKind.SMOOTHPOINT 2583.23080718973,3595.00498248335 2580.57748346512,3594.95497307221 2587.72157806317,3595.08962379752 PathPoint;PointKind.SMOOTHPOINT 2568.38963662649,3595.03223948126 2334.25406619509,3595.46224820095 2573.34824177921,3595.02313260592 PathPoint;PointKind.SMOOTHPOINT 1813.37735138759,3596.41887998843 1806.47392917458,3596.431558676 2074.54138925257,3595.93923132443 PathPoint;PointKind.SMOOTHPOINT 1792.66448805967,3596.45692082018 1784.82094337946,3597.34822749524 1799.52501423447,3595.67732013919 PathPoint;PointKind.SMOOTHPOINT 1768.90438323413,3596.50055815489 908.31395638581,3598.08110137158 1776.82471783182,3596.48601182631 PathPoint;PointKind.CORNERPOINT 45.8321235714408,3592.66868226074 45.8321235714408,3592.66868226074 45.8321235714408,3592.66868226074 PathPoint;PointKind.SMOOTHPOINT 33.2361378282803,3592.61135820006 30.1474058109025,3592.41915812034 39.833822282183,3593.02190708254 PathPoint;PointKind.SMOOTHPOINT 17.5197164301446,3586.26395811069 15.4422765141807,3583.56243659732 20.2458066270115,3589.80899027149 PathPoint;PointKind.SMOOTHPOINT 11.2931255106019,3570.54593354655 11.7814146003322,3562.93449729519 10.8892964955865,3576.84080858858 PathPoint;PointKind.SMOOTHPOINT 12.5422610402353,3522.62776556075 13.112020476172,3517.26317793072 11.9725016042985,3527.99235319078 PathPoint;PointKind.SMOOTHPOINT 12.613662992273,3506.93840302695 11.5779911088831,3502.05681184728 13.609546254706,3511.63245239513 PathPoint;PointKind.SMOOTHPOINT 12.6850649443106,3491.24904049315 12.6417365950036,3483.13006064999 12.7282200352512,3499.33555472873 PathPoint;PointKind.SMOOTHPOINT 11.2105294592683,3469.27676743824 11.6229449276014,3463.34761559529 10.7981139909352,3475.20591928119 PathPoint;PointKind.SMOOTHPOINT 12.9778129476651,3426.92265410456 13.3406786192163,3420.78233938167 12.6024254034633,3433.27486056873 PathPoint;PointKind.CORNERPOINT 11.4889970722153,3408.08825355641 11.4889970722153,3408.08825355641 11.4889970722153,3408.08825355641 PathPoint;PointKind.SMOOTHPOINT 11.5461186338454,3395.53676352937 12.195437153081,3387.10610295653 10.8298639894528,3404.83651336202 PathPoint;PointKind.SMOOTHPOINT 11.6175205858831,3379.84740099557 13.0309121132871,3373.11229825644 10.3706286901477,3385.78909857868 PathPoint;PointKind.SMOOTHPOINT 11.681782342717,3365.72697471515 10.7896656753138,3359.93489093849 12.5738990101203,3371.51905849181 PathPoint;PointKind.SMOOTHPOINT 11.7817450755698,3343.76186716782 11.2597208196516,3338.63746222057 12.303769331488,3348.88627211508 PathPoint;PointKind.SMOOTHPOINT 11.8531470276074,3328.07250463402 12.285808658295,3324.45195363603 11.1714235813263,3333.77722705154 PathPoint;PointKind.SMOOTHPOINT 11.9174087844413,3313.9520783536 10.8088715289451,3309.76475110478 13.0259460399377,3318.13940560242 PathPoint;PointKind.SMOOTHPOINT 11.9745303460715,3301.40058832656 12.36796926471,3295.13630992029 11.5810914274331,3307.66486673283 PathPoint;PointKind.SMOOTHPOINT 10.4500134946028,3290.41086904531 9.16248633668049,3281.40550285741 11.7375406525252,3299.41623523321 PathPoint;PointKind.SMOOTHPOINT 9.15398288965471,3229.2151896559 7.90503196058738,3221.64413452404 10.4029338187221,3236.78624478776 PathPoint;PointKind.SMOOTHPOINT 10.7998830595875,3213.53299262968 10.6201605433827,3208.87593308743 10.9796055757923,3218.19005217193 PathPoint;PointKind.SMOOTHPOINT 9.36104855056401,3183.71603830787 9.85216843174551,3177.61155283406 8.86992866938246,3189.82052378169 PathPoint;PointKind.SMOOTHPOINT 9.8323014340127,3080.16624558478 10.5333529507477,3075.68480038308 9.13124991727772,3084.64769078647 PathPoint;PointKind.SMOOTHPOINT 9.91084358125415,3062.9079467976 8.97012046970059,3056.01907898485 10.8929477259054,3070.09984582481 PathPoint;PointKind.CORNERPOINT 10.0536474853295,3031.52922172999 10.0536474853295,3031.52922172999 10.0536474853295,3031.52922172999 PathPoint;PointKind.CORNERPOINT 8.63623356191738,2997.00545864804 8.63623356191738,2997.00545864804 8.63623356191738,2997.00545864804 PathPoint;PointKind.SMOOTHPOINT 10.253572951035,2987.59900663535 10.8562178855294,2981.31525104058 9.65092801654064,2993.88276223011 PathPoint;PointKind.SMOOTHPOINT 8.75047668517765,2971.90247859396 8.72298427190988,2967.13170787641 8.77796909844541,2976.67324931151 PathPoint;PointKind.SMOOTHPOINT 8.9646825412907,2924.83439099255 9.37310184390643,2920.6388876977 8.42369065359329,2930.39175136408 PathPoint;PointKind.CORNERPOINT 10.6177229064272,2907.58325771296 10.6177229064272,2907.58325771296 10.6177229064272,2907.58325771296 PathPoint;PointKind.SMOOTHPOINT 9.11462664056985,2891.88672967157 9.75139336999047,2883.51117103336 8.47785991114916,2900.26228830978 PathPoint;PointKind.SMOOTHPOINT 9.6430010856487,2775.78544692143 9.83607578008447,2768.49879263307 9.48899608428722,2781.59760789302 PathPoint;PointKind.SMOOTHPOINT 9.98573045542959,2700.47650675918 10.1574755115774,2690.80079607263 9.74862366999279,2713.83454284571 PathPoint;PointKind.SMOOTHPOINT 8.82536355935302,2609.47103855555 8.75443229686242,2603.43345475301 8.89629482184368,2615.50862235809 PathPoint;PointKind.SMOOTHPOINT 10.7283107566215,2537.30713640764 11.3317924327413,2530.83952109569 10.1248290805017,2543.7747517196 PathPoint;PointKind.SMOOTHPOINT 9.31803702841302,2501.21443707231 9.67422035416109,2495.02762038283 8.96185370266504,2507.4012537618 PathPoint;PointKind.SMOOTHPOINT 9.78928991186174,2397.66464434922 9.52204422246696,2405.1823302108 9.32375883551592,2410.76014609033 PathPoint;PointKind.CORNERPOINT 10.2891035761255,2287.83910661261 10.2891035761255,2287.83910661261 10.2891035761255,2287.83910661261 PathPoint;PointKind.SMOOTHPOINT 9.26440038892063,2167.02384959475 9.14524203387274,2159.87060759228 9.38355874396852,2174.17709159721 PathPoint;PointKind.CORNERPOINT 10.9959829012986,2132.51441752797 10.9959829012986,2132.51441752797 10.9959829012986,2132.51441752797 PathPoint;PointKind.CORNERPOINT 10.0069806901125,2003.8544792432 10.0069806901125,2003.8544792432 10.0069806901125,2003.8544792432 PathPoint;PointKind.CORNERPOINT 9.45353038635633,1779.48942950225 9.45353038635633,1779.48942950225 9.45353038635633,1779.48942950225 PathPoint;PointKind.CORNERPOINT 11.3707579740323,1704.18765484758 11.3707579740323,1704.18765484758 11.3707579740323,1704.18765484758 PathPoint;PointKind.CORNERPOINT 10.5388400573291,1541.01111898846 10.5388400573291,1541.01111898846 10.5388400573291,1541.01111898846 PathPoint;PointKind.SMOOTHPOINT 12.1776000320581,1526.89785821562 11.8801964321623,1518.36687151203 12.475003631954,1535.42884491921 PathPoint;PointKind.SMOOTHPOINT 10.667363570997,1512.77026642761 10.7963679775227,1504.24530615382 10.5383591644713,1521.29522670141 PathPoint;PointKind.CORNERPOINT 11.2457193825022,1385.68642990382 11.2457193825022,1385.68642990382 11.2457193825022,1385.68642990382 PathPoint;PointKind.CORNERPOINT 11.6241497283019,1302.53280847467 11.6241497283019,1302.53280847467 11.6241497283019,1302.53280847467 PathPoint;PointKind.CORNERPOINT 12.4095712007164,1129.94982060284 12.4095712007164,1129.94982060284 12.4095712007164,1129.94982060284 PathPoint;PointKind.SMOOTHPOINT 12.4809731527541,1114.26045806904 13.3542717133437,1106.16789995407 11.6076745921646,1122.35301618402 PathPoint;PointKind.SMOOTHPOINT 12.5595152999955,1097.00215928186 12.9743194650925,1087.84519197877 12.1447111348986,1106.15912658495 PathPoint;PointKind.CORNERPOINT 11.6347748456434,954.221794716676 11.6347748456434,954.221794716676 11.6347748456434,954.221794716676 PathPoint;PointKind.SMOOTHPOINT 13.4020583340402,911.867681382995 13.2560857275949,905.200534227159 13.5480309404856,918.534828538832 PathPoint;PointKind.SMOOTHPOINT 13.5234416525043,885.195765075532 12.9141496623373,879.425397708482 14.1327336426712,890.966132442582 PathPoint;PointKind.SMOOTHPOINT 12.1417287051109,842.827320726682 12.7503981793085,835.219775168129 11.5330592309134,850.434866285234 PathPoint;PointKind.SMOOTHPOINT 12.6201217837634,737.708591750208 12.916326002059,731.186461895641 12.3239175654678,744.230721604775 PathPoint;PointKind.SMOOTHPOINT 14.2660219536962,722.026394723991 14.1076746465123,717.177397222442 14.42436926088,726.875392225539 PathPoint;PointKind.SMOOTHPOINT 12.8843090063028,679.65795037514 13.3955578375741,671.833411083225 12.3730601750315,687.482489667055 PathPoint;PointKind.SMOOTHPOINT 14.580190542662,652.993199575262 13.8489416766295,647.892357587989 15.3114394086944,658.094041562534 PathPoint;PointKind.SMOOTHPOINT 13.1913374000648,612.193691479791 14.1345634399426,604.052421329889 12.2481113601871,620.334961629694 PathPoint;PointKind.SMOOTHPOINT 13.3769824753628,571.401348891906 13.5327267562526,562.406636857454 13.2212381944731,580.396060926358 PathPoint;PointKind.SMOOTHPOINT 13.6554500883098,510.212835010078 13.6873209538581,496.902895172671 13.6235792227615,523.522774847485 PathPoint;PointKind.SMOOTHPOINT 15.6726404088386,412.94595280809 16.1006490824601,408.375747627606 15.043413651176,419.66473110582 PathPoint;PointKind.SMOOTHPOINT 16.1438932922872,309.396160084997 16.3305157790779,303.527268504762 15.9572708054965,315.265051665231 PathPoint;PointKind.SMOOTHPOINT 16.2010148539174,296.844670057955 16.6788670663378,290.952588721257 15.723162641497,302.736751394653 PathPoint;PointKind.SMOOTHPOINT 16.2938373915664,276.448498764012 17.3154893740395,269.995044104488 15.2721854090932,282.901953423536 PathPoint;PointKind.SMOOTHPOINT 16.7365294942,179.174451054439 16.8096464173533,173.019032984754 16.6634125710468,185.329869124125 PathPoint;PointKind.SMOOTHPOINT 18.375289468929,165.061190281603 18.1560328977534,158.279305640789 18.5945460401046,171.843074922416 PathPoint;PointKind.SMOOTHPOINT 18.4966727873931,138.389273974139 19.1276562588468,129.48252772146 17.8656893159393,147.296020226818 PathPoint;PointKind.SMOOTHPOINT 17.1006794495922,99.158702132049 18.4993318323359,92.7559934666355 15.7020270668485,105.561410797463 PathPoint;PointKind.SMOOTHPOINT 17.1863617920374,80.3314670914865 19.1366974667492,69.8331554412961 15.9058565817353,87.2241999383235 PathPoint;PointKind.SMOOTHPOINT 18.8893835236003,52.0977800382277 20.0997497619908,46.5236432780091 17.6790172852099,57.6719167984463 PathPoint";


frame645[0] = "PointKind.CORNERPOINT 7730.74827421318,14.1846356161941 7730.74827421318,14.1846356161941 7730.74827421318,14.1846356161941 PathPoint;PointKind.SMOOTHPOINT 7796.01607356707,14.1375478581722 7811.05399455268,12.9507013657658 7780.97815258145,15.3243943505786 PathPoint;PointKind.SMOOTHPOINT 7853.78575027651,14.0958696556772 7877.55123790133,13.0162079599731 7831.42448083029,15.1117379799271 PathPoint;PointKind.SMOOTHPOINT 7900.54417235466,3.65719821777111 7917.43196161645,2.51143605685957 7883.65638309287,4.80296037868175 PathPoint;PointKind.SMOOTHPOINT 7930.80823254579,8.83783274869256 7939.27759504233,8.33646614251938 7914.24366010874,9.81841699796496 PathPoint;PointKind.SMOOTHPOINT 7955.72465642161,6.97439702134579 7956.07274752304,7.05016855305621 7947.71939099215,5.23183244315078 PathPoint;PointKind.SMOOTHPOINT 7956.75551870366,7.23138879467933 7961.48862901567,7.4281015050974 7956.40322265867,7.21674702524888 PathPoint;PointKind.SMOOTHPOINT 7968.87164685696,16.5266178529864 7973.9777034055,22.8983554920687 7964.63078536729,11.234538433373 PathPoint;PointKind.SMOOTHPOINT 7977.62295477374,76.4361508656484 7978.30257287788,103.672365492664 7977.16651815034,58.1441045491001 PathPoint;PointKind.CORNERPOINT 7980.42643856639,149.268689773878 7980.42643856639,149.268689773878 7980.42643856639,149.268689773878 PathPoint;PointKind.SMOOTHPOINT 7980.46021865627,196.090883506795 7981.66735674671,218.191810421571 7979.6424952263,181.119567544435 PathPoint;PointKind.SMOOTHPOINT 7980.52214882105,281.931572017143 7981.43676761911,296.877907817041 7978.47458286655,248.471065417819 PathPoint;PointKind.CORNERPOINT 7980.60674066656,399.183355311964 7980.60674066656,399.183355311964 7980.60674066656,399.183355311964 PathPoint;PointKind.CORNERPOINT 7983.53408478877,643.697271240891 7983.53408478877,643.697271240891 7983.53408478877,643.697271240891 PathPoint;PointKind.SMOOTHPOINT 7983.59601495355,729.537959751239 7983.12484566711,745.970396422987 7984.06718423999,713.105523079491 PathPoint;PointKind.SMOOTHPOINT 7986.41451211948,823.180362540764 7986.02949914183,840.738515921747 7986.79952509713,805.622209159781 PathPoint;PointKind.CORNERPOINT 7983.52278002283,973.250339266358 7983.52278002283,973.250339266358 7983.52278002283,973.250339266358 PathPoint;PointKind.SMOOTHPOINT 7986.3581672337,1090.30383892234 7986.84330986458,1116.69279387662 7985.79932978177,1059.90631166516 PathPoint;PointKind.SMOOTHPOINT 7986.45012414505,1217.76425519528 7987.12217280375,1250.91379230114 7985.77807548635,1184.61471808943 PathPoint;PointKind.SMOOTHPOINT 7986.52519101145,1321.81357460177 7987.85745318061,1350.71276175724 7985.50236971065,1299.62672213165 PathPoint;PointKind.SMOOTHPOINT 7989.3849749539,1472.68310306486 7989.1074489427,1500.650861612 7989.6625009651,1444.71534451771 PathPoint;PointKind.CORNERPOINT 7992.43617940568,1888.87839601448 7992.43617940568,1888.87839601448 7992.43617940568,1888.87839601448 PathPoint;PointKind.SMOOTHPOINT 7995.35789351291,2125.58861298792 7995.7656730403,2151.57039315034 7994.95011398551,2099.6068328255 PathPoint;PointKind.SMOOTHPOINT 7995.53242397729,2367.50328060799 7995.00225610808,2383.71252224112 7996.06259184651,2351.29403897487 PathPoint;PointKind.SMOOTHPOINT 7994.7640156929,2639.50862031432 7995.61667180294,2685.98206539712 7993.91135958285,2593.03517523152 PathPoint;PointKind.SMOOTHPOINT 7991.2063386755,2951.18906221231 7992.65310453912,3010.23667213154 7989.885854767,2897.29546360391 PathPoint;PointKind.SMOOTHPOINT 7991.48971609617,3343.97524297178 7992.29705719013,3485.92889571062 7990.68237500222,3202.02159023294 PathPoint;PointKind.CORNERPOINT 7994.88998147673,4243.99987116155 7994.88998147673,4243.99987116155 7994.88998147673,4243.99987116155 PathPoint;PointKind.SMOOTHPOINT 7995.15834552412,4615.97618803973 7994.16803441067,4691.09447571568 7996.14865663757,4540.85790036377 PathPoint;PointKind.CORNERPOINT 7995.285959197,4792.86003103075 7995.285959197,4792.86003103075 7995.285959197,4792.86003103075 PathPoint;PointKind.SMOOTHPOINT 7995.35351937677,4886.50441849658 7993.72254295619,4906.28508133633 7997.73209448869,4857.65679584882 PathPoint;PointKind.SMOOTHPOINT 7995.45485964641,5026.97099969534 7994.36484158609,5043.31620221971 7996.54487770673,5010.62579717096 PathPoint;PointKind.SMOOTHPOINT 7992.76893871352,5418.51078290215 7992.65882053094,5442.35640241227 7992.8790568961,5394.66516339203 PathPoint;PointKind.SMOOTHPOINT 7990.9543530335,5675.51215892728 7990.42657933187,5719.55527606327 7991.34510805104,5642.90335527555 PathPoint;PointKind.SMOOTHPOINT 7986.32568263514,5888.78985341883 7985.97211039327,5912.42366853273 7986.57510025344,5872.1180416107 PathPoint;PointKind.SMOOTHPOINT 7976.1308984975,5969.22683731612 7971.72043906492,5977.01780026157 7980.01175685945,5962.37140101595 PathPoint;PointKind.SMOOTHPOINT 7962.38184358166,5977.04045965315 7961.32171379389,5977.52013121183 7964.02950564137,5976.29495034149 PathPoint;PointKind.SMOOTHPOINT 7835.83686554645,5974.53052177822 7824.19286677823,5974.62993867167 7847.48086431466,5974.43110488476 PathPoint;PointKind.SMOOTHPOINT 7692.2969446527,5984.23531548394 7671.50282889736,5985.79233480172 7713.09106040804,5982.67829616616 PathPoint;PointKind.SMOOTHPOINT 7436.46168161111,5987.02112336587 7426.34294516422,5986.221201119 7446.58041805799,5987.82104561274 PathPoint;PointKind.SMOOTHPOINT 7287.91108435825,5987.12829588657 6319.74670112075,5998.16079151115 7304.81873079287,5986.93562867164 PathPoint;PointKind.CORNERPOINT 4287.63883664315,5989.29902459457 4287.63883664315,5989.29902459457 4287.63883664315,5989.29902459457 PathPoint;PointKind.CORNERPOINT 3044.21907224031,5995.3985642567 3044.21907224031,5995.3985642567 3044.21907224031,5995.3985642567 PathPoint;PointKind.CORNERPOINT 625.132041719108,5978.54258736585 625.132041719108,5978.54258736585 625.132041719108,5978.54258736585 PathPoint;PointKind.SMOOTHPOINT 72.6986146625468,5983.14361145433 67.0546685123782,5983.24752689493 93.6601832027827,5981.14504744946 PathPoint;PointKind.SMOOTHPOINT 56.4376144801045,5982.14734140317 52.6892246929565,5981.08982691802 61.7190135840192,5983.63735614855 PathPoint;PointKind.SMOOTHPOINT 44.1706932052293,5978.24548032808 41.7979628091716,5977.15420961477 49.5735246231425,5980.73036091338 PathPoint;PointKind.SMOOTHPOINT 36.1663665603792,5972.25125352535 34.2819147754672,5969.29150265489 37.5971448927066,5974.49845743285 PathPoint;PointKind.SMOOTHPOINT 32.1555457842815,5957.25414324696 30.6051775490023,5949.73366430909 32.9836774224968,5961.27121893341 PathPoint;PointKind.SMOOTHPOINT 28.646089450719,5931.15070657204 28.4092890473694,5902.43867819575 28.7281946134553,5941.10595043545 PathPoint;PointKind.CORNERPOINT 28.5495519564429,5452.11872307198 28.5495519564429,5452.11872307198 28.5495519564429,5452.11872307198 PathPoint;PointKind.SMOOTHPOINT 24.4941203730623,5375.28708634632 24.1828012775786,5346.59814390756 24.7899499438699,5402.5486249146 PathPoint;PointKind.SMOOTHPOINT 24.4265601933002,5281.64269888049 24.0853766656519,5255.38203656283 24.7677437209468,5307.90336119815 PathPoint;PointKind.SMOOTHPOINT 18.8158392646874,5130.77515509371 16.8445979778553,5107.15323598248 20.7870805515186,5154.39707420494 PathPoint;PointKind.CORNERPOINT 4.9587413328909,4293.18769517281 4.9587413328909,4293.18769517281 4.9587413328909,4293.18769517281 PathPoint;PointKind.SMOOTHPOINT 12.7846425492316,4051.86848942261 13.880840012358,4029.23162514949 11.6884450861035,4074.50535369574 PathPoint;PointKind.SMOOTHPOINT 12.7264657277692,3971.23026688259 12.1013014937589,3946.3705519722 13.3516299617777,3996.08998179298 PathPoint;PointKind.SMOOTHPOINT 9.88920184524068,3851.57553424144 8.80290746217452,3834.05955337941 11.1354662540552,3871.67095577185 PathPoint;PointKind.SMOOTHPOINT 9.74469812741427,3651.28059438396 9.30889742555337,3630.32450252136 10.1804988292752,3672.23668624657 PathPoint;PointKind.SMOOTHPOINT 9.63022115614967,3492.60538228908 11.2725470831729,3472.79491578011 7.98789522912648,3512.41584879804 PathPoint;PointKind.CORNERPOINT 6.75354716875972,3318.32475695953 6.75354716875972,3318.32475695953 6.75354716875972,3318.32475695953 PathPoint;PointKind.CORNERPOINT 14.2006484015219,2551.95525444069 14.2006484015219,2551.95525444069 14.2006484015219,2551.95525444069 PathPoint;PointKind.CORNERPOINT 8.24274321579378,1919.85960839892 8.24274321579378,1919.85960839892 8.24274321579378,1919.85960839892 PathPoint;PointKind.CORNERPOINT 10.652125959823,1446.43322042311 10.652125959823,1446.43322042311 10.652125959823,1446.43322042311 PathPoint;PointKind.CORNERPOINT 14.0244490589339,576.41605054977 14.0244490589339,576.41605054977 14.0244490589339,576.41605054977 PathPoint;PointKind.SMOOTHPOINT 13.9456288492102,467.164265172963 13.4598833286964,436.55240971902 14.4313743697239,497.776120626905 PathPoint;PointKind.SMOOTHPOINT 17.5621711202284,280.878952159302 17.1041835014812,228.744931150221 18.0201587389756,333.012973168383 PathPoint;PointKind.SMOOTHPOINT 21.1827544263242,100.194871350057 21.4889477806955,74.6989404909846 20.8765610719547,125.69080220913 PathPoint;PointKind.SMOOTHPOINT 21.150851008103,55.9739106023017 22.3385574030708,43.97359768354 19.0220463113956,77.4828648452531 PathPoint;PointKind.SMOOTHPOINT 23.8809290745266,32.2585710361045 24.9428964284343,29.3037692733606 22.0176622751769,37.4428961501735 PathPoint;PointKind.SMOOTHPOINT 25.8744354637756,23.2571304693938 26.6263369275866,22.4822051603051 23.4984340416258,25.7058870220471 PathPoint;PointKind.SMOOTHPOINT 31.8729909933409,21.252802263054 34.8289692206517,20.5513893537081 30.7139691877337,21.5278221698836 PathPoint;PointKind.SMOOTHPOINT 40.8729886511055,21.2463091727996 45.6105637850887,20.6387945891129 37.6391829836302,21.6609905336736 PathPoint;PointKind.SMOOTHPOINT 53.872985267878,21.2369302646548 55.9854667283589,21.2729982063001 48.3413749279907,21.1424850339245 PathPoint;PointKind.SMOOTHPOINT 59.8729837063884,21.2326015378185 62.102989141089,21.2629780464476 57.4219099710854,21.1992136987965 PathPoint;PointKind.SMOOTHPOINT 66.5837380045723,22.0931822845914 68.9957750864887,22.4418138633464 64.6435263264157,21.8127475161764 PathPoint;PointKind.SMOOTHPOINT 73.4174254286045,22.1163146700565 78.2046483696349,21.1422315355694 71.3206557793592,22.5429561650089 PathPoint;PointKind.SMOOTHPOINT 85.8729769399315,21.2138437215281 87.7992874142346,21.0716957025725 82.0974168830971,21.4924532134501 PathPoint;PointKind.SMOOTHPOINT 91.8729753784419,21.2095149946917 97.4069283217823,21.4504039692574 89.9873052357252,21.1274331353598 PathPoint;PointKind.SMOOTHPOINT 109.156437833773,22.0943721532976 118.428801106328,22.8060825360872 102.696421928839,21.5985265681556 PathPoint;PointKind.SMOOTHPOINT 147.66955564007,22.0665866849677 170.873716716895,21.3391120403976 137.931068259439,22.3718984186007 PathPoint;PointKind.SMOOTHPOINT 459.778535548598,22.2401806484913 507.202335410794,23.6494410142277 412.354735686403,20.8309202827559 PathPoint;PointKind.SMOOTHPOINT 778.883472600312,16.8074922262895 829.522080221835,15.8851918601295 728.244864978787,17.7297925924495 PathPoint;PointKind.SMOOTHPOINT 875.166267116054,16.7380285554646 911.432424903008,16.3373540118255 839.067657443138,17.1368519996695 PathPoint;PointKind.SMOOTHPOINT 943.939691770155,16.6884116477322 964.673061639543,17.243158122229 924.426951574233,16.1663246016005 PathPoint;PointKind.SMOOTHPOINT 1001.7093684796,16.6467334452364 946.688645182323,17.0483508599027 977.056546311045,16.8266838731888 PathPoint;PointKind.SMOOTHPOINT 1425.35366434887,16.3410932936058 1484.0334440563,16.3879126876936 1272.19420745731,16.218890500646 PathPoint;PointKind.CORNERPOINT 1848.99796021814,16.0354531419744 1848.99796021814,16.0354531419744 1848.99796021814,16.0354531419744 PathPoint;PointKind.SMOOTHPOINT 1926.02231915907,13.3786492201525 1959.56352990456,12.4794061018501 1891.83064700164,14.2953312720956 PathPoint;PointKind.CORNERPOINT 2421.18909999694,10.4201744993179 2421.18909999694,10.4201744993179 2421.18909999694,10.4201744993179 PathPoint;PointKind.SMOOTHPOINT 2591.74719313912,10.297124568142 2611.60693862447,10.3342300439963 2568.71844569365,10.2540982044384 PathPoint;PointKind.SMOOTHPOINT 2759.55434929513,10.1760593132749 2781.70930044704,10.0704312288526 2720.14225605574,10.3639642146845 PathPoint;PointKind.SMOOTHPOINT 3128.17802876945,7.30887970266758 3160.52795920516,7.63068580630807 3094.26594907121,6.97153386955324 PathPoint;PointKind.SMOOTHPOINT 3396.77634676403,16.1151005365946 3432.76971898106,16.365907790725 3343.64813650985,15.7448951429369 PathPoint;PointKind.SMOOTHPOINT 3669.11723172262,13.3173845968131 3714.82798998082,13.2505129459087 3622.54565983104,13.3855155580186 PathPoint;PointKind.SMOOTHPOINT 3911.19968650505,13.142733081595 3947.18453954742,13.1573107542936 3874.45991502745,13.1278495870602 PathPoint;PointKind.CORNERPOINT 4466.8889577102,12.7418284671176 4466.8889577102,12.7418284671176 4466.8889577102,12.7418284671176 PathPoint;PointKind.SMOOTHPOINT 4700.71484819082,7.37066501050322 4750.42965229058,8.14019539175752 4649.58005353519,6.57915474028778 PathPoint;PointKind.CORNERPOINT 5138.11570566257,9.6563344624883 5138.11570566257,9.6563344624883 5138.11570566257,9.6563344624883 PathPoint;PointKind.CORNERPOINT 6161.46238784395,6.31680189026883 6161.46238784395,6.31680189026883 6161.46238784395,6.31680189026883 PathPoint;PointKind.SMOOTHPOINT 6552.09543987925,6.03497785434956 6605.51499267232,5.69529577622507 6498.67588708617,6.37465993247406 PathPoint;PointKind.SMOOTHPOINT 7190.31282066931,5.57453295059349 7268.56105096054,6.40900732741102 7112.06459037809,4.74005857377688 PathPoint";

// Build the path

function createPath(thisFrame) {
	
	var thisPathPointInfo = thisFrame.split(";");
	var thisPathPointInfoProperties = [];
	
	var p = [];
	var pth = [];
	
	for (var i = 0; i < thisPathPointInfo.length; i++ ) {
		
		thisPathPointInfoProperties = thisPathPointInfo[i].split(" "); // Splitta thisPathPointInfo i dess properties
		
		p[i] = new PathPointInfo();
		p[i].kind = thisPathPointInfoProperties[0];
	
		var anchorString = thisPathPointInfoProperties[1].split(",");
		p[i].anchor = [anchorString[0]*1, anchorString[1]*1];
		
		var leftDirectionString = thisPathPointInfoProperties[2].split(",");
		p[i].leftDirection = [leftDirectionString[0]*1, leftDirectionString[1]*1];
		
		var rightDirectionString = thisPathPointInfoProperties[3].split(",");
		p[i].rightDirection = [rightDirectionString[0]*1, rightDirectionString[1]*1];

		p[i].typename = thisPathPointInfoProperties[4];
	
	}

	pth[0] = new SubPathInfo();
	pth[0].operation = ShapeOperation.SHAPEXOR;
	pth[0].closed = true;
	pth[0].entireSubPath = p;
	
	app.activeDocument.pathItems.add("Frame", pth);
	
}

function biggerCanvas() {
	
	if ( ratio > 1 ) {
			
			var new_doc_height = doc_height * borderThickness / ratio / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness / 100 + doc_width;
	
			var offset = offset_factor * borderThickness / 100 * doc_width / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(offset + doc_width,"px"), UnitValue(doc_height,"px"), AnchorPosition.MIDDLERIGHT);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
			
		} else {
			
			var new_doc_height = doc_height * borderThickness / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness * ratio / 100 + doc_width;
			
			var offset = offset_factor * borderThickness / 100 * doc_height / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(doc_width,"px"), UnitValue(offset + doc_height,"px"), AnchorPosition.TOPCENTER);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
		}

}


// Generate a number between 0 and max, including max
function generateRandomInteger(max) {
    return Math.floor(Math.random() * max) + 1;
}

function format(){
	
	if (doc_height > doc_width) {
		if (doc_height/doc_width < 1.1) {
			var format = "square";
		}
		else if (doc_height/doc_width > 1.1 && doc_height/doc_width < 1.2) {
			var format = "67";
		}
		else if (doc_height/doc_width > 1.2 && doc_height/doc_width < 1.4) {
			var format = "645";
		}
		else if (doc_height/doc_width > 1.4) {
			var format = "35mm";
		}
	}
	else {
		if (doc_width/doc_height < 1.1) {
			var format = "square";
		}
		else if (doc_width/doc_height > 1.1 && doc_width/doc_height < 1.2) {
			var format = "67";
		}
		else if (doc_width/doc_height > 1.2 && doc_width/doc_height < 1.4) {
			var format = "645";
		}
		else if (doc_width/doc_height > 1.4) {
			var format = "35mm";
		}
	}

	return format;
}


// LET'S GET THIS SHOW GOING!!!!

app.activeDocument.resizeImage(null, null, 72, ResampleMethod.NONE); // Necessary to resample to 72dpi for the frame to fit


// Choosing the frame

var thisFormat = format();

if (thisFormat == "square") {
	
} 
else if (thisFormat == "67") {
	
} 
else if (thisFormat == "645") {
	var useFrame = frame645[generateRandomInteger(frame645.length) - 1];
}
else if (thisFormat == "35mm") {
	var useFrame = frame35mm[generateRandomInteger(frame35mm.length) - 1];
}

//var useFrame = frame645[1]; // this sets the used frame. Change for logic.

// Drawing path

if (ratio > 1 ){
	// For portrait we need to rotate before placing path. We also add some random flipping to simulate holding the camera in opposite way.
	
	if (generateRandomInteger(10) < 7) {
		
		app.activeDocument.rotateCanvas(-90);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(90);
		
	} else {
		
		app.activeDocument.rotateCanvas(-270);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(270);
		
	}
	
} else {
	if (generateRandomInteger(10) < 7) {
		
		createPath(useFrame);
		
	} else {
		
		app.activeDocument.rotateCanvas(-180);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(180);
		
	}
}

biggerCanvas(); // Enlarge canvas

app.activeDocument.pathItems.getByName('Frame').makeSelection(feather, true); // Make selection from path

app.activeDocument.pathItems.getByName('Frame').remove(); // Trash path

app.activeDocument.selection.invert(); // Invert selection

var myColor = new SolidColor();  
myColor.rgb.red = 0;  
myColor.rgb.green = 0;  
myColor.rgb.blue = 0;  

app.activeDocument.selection.fill(myColor); // Fill with black

app.activeDocument.selection.deselect(); // Unnecessary?

//app.activeDocument.save();

//app.activeDocument.close();
