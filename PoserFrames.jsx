#target photoshop


// Settings

var borderThickness = 4; // Border width in %
var offset_factor = 1; // How much offset is allowed, where 1 is maximun
var feather_factor = 1200; // How much feathering of the border you like. The lower value, the more feathering.

// Initial

app.preferences.rulerUnits = Units.PIXELS;
app.displayDialogs.NO;

var doc_height = app.activeDocument.height;
var doc_width = app.activeDocument.width;
var ratio = doc_height / doc_width;

if (ratio > 1) {
	var feather = doc_width / feather_factor;
} else {
	var feather = doc_height / feather_factor;
}

var frameSquare = [];
var frame67 = [];
var frame645 = [];
var frame35mm = [];


// Frames

frame35mm[0] = "PointKind.CORNERPOINT 10,36 10,36 10,36 PathPoint;PointKind.SMOOTHPOINT 10.170283672805,31.0470569698894 11.2540813176504,26.2788794414753 9.52105658812071,33.9033373934099 PathPoint;PointKind.SMOOTHPOINT 18.5759646977006,16.5447663442753 22.2713671597052,13.9569236418135 12.6620579898118,20.6861989688419 PathPoint;PointKind.SMOOTHPOINT 35,12 42.023642823877,11.0532015001705 29.6869000846633,12.7162145279062 PathPoint;PointKind.SMOOTHPOINT 57.1680673335252,11.6439687058437 59.4808034734315,11.6105050226961 49.4984999047528,11.754942011396 PathPoint;PointKind.SMOOTHPOINT 64.174512433331,11.5456263582077 67.0235053516582,10.8280188033227 61.8881140792879,12.1215269586561 PathPoint;PointKind.SMOOTHPOINT 69.4656750929525,11.475166681997 132.334924551752,10.6563998639688 67.6906112665326,11.4982839193342 PathPoint;PointKind.SMOOTHPOINT 273.122937564769,10.1792086470092 290.647187445139,10.1417882337579 217.106980280759,10.2988223414351 PathPoint;PointKind.SMOOTHPOINT 324,10 337.510565153717,9.97196995235051 306.498198512012,10.0363105705852 PathPoint;PointKind.SMOOTHPOINT 366.173113390772,9.98550917867583 391.522977062455,9.93409256488726 352.676581901851,10.0128839194649 PathPoint;PointKind.SMOOTHPOINT 442,9 582.627291098396,8.72687975528027 416.702548342515,9.04913161686833 PathPoint;PointKind.SMOOTHPOINT 859.184120778175,4.11743469036532 871.231093885475,4.09952760255337 720.560522155707,4.32349018092152 PathPoint;PointKind.SMOOTHPOINT 890,6 894.864269094842,5.99295369705734 877.970831421137,6.01742526252195 PathPoint;PointKind.SMOOTHPOINT 907.21157576914,6.74098542393773 932.14247766449,6.20509820639519 900.143360695246,6.89291599286945 PathPoint;PointKind.SMOOTHPOINT 984,5 1001.56077565271,4.97576660379909 966.890891314404,5.02361010798282 PathPoint;PointKind.SMOOTHPOINT 1013.89210772595,3.89995053585238 1101.90872495922,3.78326364480133 996.372294416886,3.9231772015786 PathPoint;PointKind.SMOOTHPOINT 1276.28082749127,3.58698399895228 1517.15515870378,3.33130975854738 1189.39996135184,3.67920303841614 PathPoint;PointKind.SMOOTHPOINT 1983.01766466295,3.07630154661655 1989.78601357154,3.07363890775191 1753.33783436604,3.16665658753297 PathPoint;PointKind.SMOOTHPOINT 2003.0286627052,3.06278756590418 2025.79866096523,3.04201210099504 1996.44011367102,3.06879899233024 PathPoint;PointKind.SMOOTHPOINT 2071,3 2075.1647807327,2.25495972359611 2047.55134836719,7.19474421705815 PathPoint;PointKind.SMOOTHPOINT 2083.89064365844,2.99783884394672 2103.17249261077,2.99694847389398 2079.53734340533,2.998039864512 PathPoint;PointKind.SMOOTHPOINT 2142,3 2167.73552870003,2.99355161515304 2123.37351410552,3.00466711800617 PathPoint;PointKind.SMOOTHPOINT 2219,3 2434.11950790793,2.96080724638606 2193.44578357341,3.00465573818918 PathPoint;PointKind.SMOOTHPOINT 2845.01647057769,4.06429395225102 2864.39978652798,4.07120484208303 2644.51744349488,3.99280841844713 PathPoint;PointKind.SMOOTHPOINT 2904,3 2929.07959461718,3.0101665076434 2884.76956018427,2.99220456245976 PathPoint;PointKind.SMOOTHPOINT 2981,4 3314.93080340567,4.15636394675127 2956.18603016522,3.98838079560687 PathPoint;PointKind.SMOOTHPOINT 3901.81759285844,4.90339241367725 3934.44575531477,4.94368703540723 3624.30153223488,4.56066993576305 PathPoint;PointKind.SMOOTHPOINT 4000,4 4023.5194342743,4.03096064633581 3968.27116553866,3.95823261686706 PathPoint;PointKind.SMOOTHPOINT 4068.16096181661,5.1204963135601 4108.83278537804,5.17644766334232 4045.14771089474,5.08883748100222 PathPoint;PointKind.SMOOTHPOINT 4187.75263838089,5.29113899493546 4356.69163114686,5.54088561134524 4148.70609912382,5.23341554754002 PathPoint;PointKind.SMOOTHPOINT 4645.84994022971,6.06167360734698 4664.25593337081,6.09651951768789 4510.15380244818,5.80477600804358 PathPoint;PointKind.SMOOTHPOINT 4700.08159905698,6.16577261794156 4721.85203977353,6.20813921674067 4682.33505730055,6.13123677071387 PathPoint;PointKind.SMOOTHPOINT 4765,5 5020.91192904346,5.51435654902216 4744.24111038836,4.95827677567792 PathPoint;PointKind.SMOOTHPOINT 5314.93874505992,13.3357271176007 5319.09114668457,13.3803790827191 5222.15196530452,12.3379642739281 PathPoint;PointKind.SMOOTHPOINT 5326.75189074649,13.4645297705516 5331.56270210143,12.561073172787 5323.09406442638,14.151459080094 PathPoint;PointKind.SMOOTHPOINT 5337.79909595325,13.5883979057019 5360.12105266333,13.8422704315611 5334.36247551298,13.5493124651682 PathPoint;PointKind.CORNERPOINT 5372,14 5372,14 5372,14 PathPoint;PointKind.SMOOTHPOINT 5386.99925354679,20.3018627889365 5389.62617735979,22.7895286659075 5380.71339507129,14.3492289289198 PathPoint;PointKind.SMOOTHPOINT 5392.39994221556,32.297076468452 5392.75404896652,34.3041186944204 5391.43621137921,26.8347449037724 PathPoint;PointKind.SMOOTHPOINT 5393,39 5393.03719265001,41.6337595769186 5392.96512646561,36.530466230444 PathPoint;PointKind.SMOOTHPOINT 5393.10546519735,46.9807775350082 5393.18712851263,53.5967533942476 5393.07230930668,44.2946439685116 PathPoint;PointKind.SMOOTHPOINT 5393.31649232937,67.2601963843774 5393.3380841953,69.7580545125502 5393.25689699397,60.3659014028765 PathPoint;PointKind.SMOOTHPOINT 5393.37734361173,74.8017209482496 5393.93609570965,78.137823830548 5392.8895906621,71.8895278179929 PathPoint;PointKind.SMOOTHPOINT 5393.44705088914,85.0269423567225 5393.92327559931,162.425246975541 5393.42592625329,81.5936660772562 PathPoint;PointKind.SMOOTHPOINT 5394,317 5394.15313814005,332.566143135543 5393.35977311069,251.92239493917 PathPoint;PointKind.SMOOTHPOINT 5394,368 5394.14407450734,383.217572083581 5393.85280025162,352.452330790633 PathPoint;PointKind.SMOOTHPOINT 5392.68440086091,413.858899357353 5393.55694086647,509.62591359845 5392.545934532,398.661307489372 PathPoint;PointKind.SMOOTHPOINT 5393.98035356098,697.620134967417 5394.19837075494,728.817171861864 5393.31892780991,602.973822057585 PathPoint;PointKind.SMOOTHPOINT 5397,785 5397.13358010061,806.094602588875 5396.80347639883,753.9655326864 PathPoint;PointKind.SMOOTHPOINT 5394.98819101932,854.133405525704 5396.33465018258,1082.42271792715 5394.86426354256,833.121763117054 PathPoint;PointKind.SMOOTHPOINT 5393.48240915545,1520.67448527614 5393.63095942693,1607.93353179477 5393.11801519421,1306.62795881544 PathPoint;PointKind.SMOOTHPOINT 5392,1769 5392.00592882918,1795.11414393102 5391.98094293553,1685.06118015701 PathPoint;PointKind.SMOOTHPOINT 5393.72963586753,1855.42131111837 5393.65718684548,2203.21613932007 5393.73500145584,1829.66356020256 PathPoint;PointKind.SMOOTHPOINT 5392.2277382381,2779.60348168344 5392.07192643685,2809.61483914772 5393.58195085738,2518.76470905759 PathPoint;PointKind.SMOOTHPOINT 5390,2866 5389.81490344502,2898.61048270668 5390.16209559876,2837.44184708927 PathPoint;PointKind.SMOOTHPOINT 5390,2967 5389.74711243295,3007.72096559144 5390.19021112603,2936.37144515052 PathPoint;PointKind.SMOOTHPOINT 5390.42253013289,3079.03100469279 5388.9935314806,3286.38776430369 5390.67769901363,3042.00438316442 PathPoint;PointKind.SMOOTHPOINT 5389.75957922045,3509.34946491506 5389.6754684602,3514.73134413004 5390.87906518195,3437.71846063713 PathPoint;PointKind.SMOOTHPOINT 5390.52480973209,3530.11755845057 5390.29210035533,3533.23613495809 5390.85166188809,3525.73735912499 PathPoint;PointKind.SMOOTHPOINT 5390.38260447506,3538.80648936633 5390.14097723071,3553.39679209186 5390.42673128844,3536.1419571972 PathPoint;PointKind.CORNERPOINT 5390,3561 5390,3561 5390,3561 PathPoint;PointKind.SMOOTHPOINT 5390.03726826051,3563.0383782373 5389.91217887365,3569.45970442485 5390.06210306048,3561.76351107743 PathPoint;PointKind.SMOOTHPOINT 5364,3589 5320.25097122963,3589.27066226776 5387.5814803964,3588.85410837359 PathPoint;PointKind.SMOOTHPOINT 5214.0148500136,3589.50205927216 5210.92711723231,3589.50858502113 5264.81223921478,3589.39470185695 PathPoint;PointKind.SMOOTHPOINT 5204.74909802234,3589.52148078839 5199.8539805719,3589.99401518466 5208.11774676706,3589.19629913199 PathPoint;PointKind.SMOOTHPOINT 5190.0019879213,3589.55207082804 5140.99223988197,3589.65377894537 5194.91362078541,3589.54187789803 PathPoint;PointKind.SMOOTHPOINT 5050.46065923617,3589.98480492049 5039.39012432788,3590.04415153099 5092.57821553685,3589.7590223156 PathPoint;PointKind.SMOOTHPOINT 5035.03442345482,3588.11840951359 5033.74107042032,3588.1335937739 5041.5940615899,3588.04139786219 PathPoint;PointKind.SMOOTHPOINT 5030,3588 5008.48085040853,3588.11291984281 5032.11841100255,3587.98888382478 PathPoint;PointKind.SMOOTHPOINT 4890,3589 4853.59039894928,3589.18439828532 4911.49505742744,3588.8911371831 PathPoint;PointKind.SMOOTHPOINT 4836,3589 4830.72856615621,3589.1319613151 4858.19988504949,3588.44426391129 PathPoint;PointKind.SMOOTHPOINT 4811.39461297814,3591.1855191919 4562.36521066078,3592.35343109093 4820.01635602624,3591.1450844633 PathPoint;PointKind.SMOOTHPOINT 4072.77375238875,3591.27216544369 4032.09522185443,3591.17463515945 4315.70069563807,3591.85460373521 PathPoint;PointKind.SMOOTHPOINT 3951.15252232324,3591.26050738082 3922.86233513269,3591.33167699276 3991.54953317889,3591.15888063772 PathPoint;PointKind.SMOOTHPOINT 3862,3590 3813.60040204111,3590.11221998234 3890.16112371073,3589.9347052261 PathPoint;PointKind.SMOOTHPOINT 3721.87933881304,3591.77643707856 3700.69494507711,3591.81855090699 3769.87030807154,3591.68103272236 PathPoint;PointKind.SMOOTHPOINT 3658.44909746991,3591.90408814447 3642.55210730053,3588.96438815088 3679.1992515246,3595.74124392627 PathPoint;PointKind.SMOOTHPOINT 3615.69126926193,3591.99170915598 3601.41265147532,3592.02115630902 3629.92433735746,3591.96235594122 PathPoint;PointKind.SMOOTHPOINT 3572.91538661767,3592.08042682169 3293.95170732289,3592.66206307971 3587.15386184057,3592.05073975465 PathPoint;PointKind.SMOOTHPOINT 2763.07474388879,3593.69895573136 2740.99425172649,3593.73427966786 3022.78583732864,3593.28347503888 PathPoint;PointKind.SMOOTHPOINT 2697.08391065014,3593.80031094021 2683.98993085224,3595.97529156475 2722.81687068813,3589.52592757027 PathPoint;PointKind.SMOOTHPOINT 2657.35790260158,3593.85697965185 2395.48243982353,3594.21906510116 2670.56836709143,3593.8387140346 PathPoint;PointKind.SMOOTHPOINT 1912.99901889075,3593.93303925392 1873.43284029,3593.86538457269 2146.06579932343,3594.33156292476 PathPoint;PointKind.SMOOTHPOINT 1795.71575604845,3593.71931718813 1753.88847442325,3593.63839824899 1834.33234645637,3593.79402473325 PathPoint;PointKind.SMOOTHPOINT 1671.96020642136,3593.46523203245 1636.11005936817,3593.38737667653 1712.62890748026,3593.5535517872 PathPoint;PointKind.SMOOTHPOINT 1565.80305994913,3593.22388011649 1364.1244864281,3592.74479698158 1600.71905766991,3593.30682232178 PathPoint;PointKind.SMOOTHPOINT 1011.36674288918,3591.15136049848 1002.70205698336,3591.1091576961 1178.29367179418,3591.96440603397 PathPoint;PointKind.SMOOTHPOINT 984,3590 969.163012662973,3592.89387411796 992.404131532805,3588.36081960749 PathPoint;PointKind.SMOOTHPOINT 940.585102646911,3590.79963292275 782.31809760054,3589.99876008194 955.403180307936,3590.87461630889 PathPoint;PointKind.SMOOTHPOINT 524.440840408577,3588.66733829629 491.162923625687,3588.5163609557 642.643365136135,3589.20360692604 PathPoint;PointKind.SMOOTHPOINT 423,3586 400.038782135179,3585.89027789175 452.809841205035,3586.14244883015 PathPoint;PointKind.SMOOTHPOINT 364.06636401182,3587.90669047255 252.771563597136,3587.35471794001 384.902494887225,3588.01002838128 PathPoint;PointKind.SMOOTHPOINT 75.6029135111268,3586.2102989509 65.5859579326959,3585.98167100727 121.219531353338,3587.2514569605 PathPoint;PointKind.SMOOTHPOINT 59.0569435701094,3586.15352563461 60.7631935701094,3586.29102563461 58.7284358661381,3586.12705248631 PathPoint;PointKind.SMOOTHPOINT 56.0188373843679,3586.13358411797 43.0757251965783,3586.0484780851 56.9981255766075,3586.14002332145 PathPoint;PointKind.CORNERPOINT 36,3586 36,3586 36,3586 PathPoint;PointKind.SMOOTHPOINT 14,3557 13.9126086454025,3549.87529422611 14.3581822787307,3586.20132501816 PathPoint;PointKind.SMOOTHPOINT 13.7613979459782,3535.51950957958 14.1188941596958,3531.83259244007 13.0670250720928,3542.68069101788 PathPoint;PointKind.SMOOTHPOINT 13.662425895482,3525.08297271687 13.6218192088842,3520.56228872929 13.6937409755951,3528.56923552476 PathPoint;PointKind.SMOOTHPOINT 13.5487686139103,3511.48508455784 13.0912632531061,3452.45413129744 13.583987956534,3516.02936216942 PathPoint;PointKind.SMOOTHPOINT 13.1400402375445,3329.1562328066 13.1505620476236,3319.25176940812 13.0745035539813,3390.84767930941 PathPoint;PointKind.SMOOTHPOINT 13.1764860737118,3299.44657656789 10.4691279896708,3288.97869411606 16.1710176120351,3311.02480270881 PathPoint;PointKind.SMOOTHPOINT 13.2203570927767,3267.05211515876 13.3108458749145,3197.85312111723 13.2062611470231,3277.83163106309 PathPoint;PointKind.SMOOTHPOINT 12.8354772419437,3065.86631305497 12.5592916661576,3031.85209700635 13.3530307540653,3129.60670546295 PathPoint;PointKind.SMOOTHPOINT 12,2967 11.8335731570887,2944.1298775646 12.2458619677067,3000.78597589968 PathPoint;PointKind.SMOOTHPOINT 11,2892 10.9229040576684,2880.52780458788 11.1529362342368,2914.75754484213 PathPoint;PointKind.SMOOTHPOINT 11.3474772228684,2861.34567757342 9.32067114910792,2546.80033155173 11.4212072316854,2872.78803085811 PathPoint;PointKind.SMOOTHPOINT 4.62478301027623,1961.59396462241 4.63468933935014,1919.75736800336 4.55775055346345,2244.68670615507 PathPoint;PointKind.SMOOTHPOINT 2,1840 2.02074907979544,1821.02363655963 1.95524167555655,1880.93435660738 PathPoint;PointKind.SMOOTHPOINT 4.78037138631721,1780.79712792325 5.59105774380053,1233.29889809496 4.7525729037329,1799.5708742264 PathPoint;PointKind.SMOOTHPOINT 8.61959664479233,467.823613719031 8.69354125185166,459.650239504449 5.86529178407134,772.267240144043 PathPoint;PointKind.SMOOTHPOINT 8.84685142278663,443.643433790264 10.3151397146857,433.869193715496 7.66634614895735,451.501932710128 PathPoint;PointKind.SMOOTHPOINT 9.13482546135429,415.474813783623 9.17697795951189,411.537093088799 9.03609722838226,424.697617250305 PathPoint;PointKind.SMOOTHPOINT 9.26280608231339,403.753448856326 9.65722036709749,368.337365940067 9.21963553332244,407.629910236118 PathPoint;PointKind.SMOOTHPOINT 9,313 9.22325009994407,294.436368726001 8.63707075188693,343.178193614285 PathPoint;PointKind.SMOOTHPOINT 9,253 8.40938894359773,178.28762366663 9.13042551810522,269.498845198581 PathPoint;PointKind.SMOOTHPOINT 9,67 8.91197516855271,61.3405230232647 9.61224244762615,106.363574795316 PathPoint;PointKind.SMOOTHPOINT 10,52 10.8272032255383,38.1612343415949 9.63150315686147,58.1647988071341 PathPoint";


frame645[0] = "PointKind.CORNERPOINT 7730.74827421318,14.1846356161941 7730.74827421318,14.1846356161941 7730.74827421318,14.1846356161941 PathPoint;PointKind.SMOOTHPOINT 7796.01607356707,14.1375478581722 7811.05399455268,12.9507013657658 7780.97815258145,15.3243943505786 PathPoint;PointKind.SMOOTHPOINT 7853.78575027651,14.0958696556772 7877.55123790133,13.0162079599731 7831.42448083029,15.1117379799271 PathPoint;PointKind.SMOOTHPOINT 7900.54417235466,3.65719821777111 7917.43196161645,2.51143605685957 7883.65638309287,4.80296037868175 PathPoint;PointKind.SMOOTHPOINT 7930.80823254579,8.83783274869256 7939.27759504233,8.33646614251938 7914.24366010874,9.81841699796496 PathPoint;PointKind.SMOOTHPOINT 7955.72465642161,6.97439702134579 7956.07274752304,7.05016855305621 7947.71939099215,5.23183244315078 PathPoint;PointKind.SMOOTHPOINT 7956.75551870366,7.23138879467933 7961.48862901567,7.4281015050974 7956.40322265867,7.21674702524888 PathPoint;PointKind.SMOOTHPOINT 7968.87164685696,16.5266178529864 7973.9777034055,22.8983554920687 7964.63078536729,11.234538433373 PathPoint;PointKind.SMOOTHPOINT 7977.62295477374,76.4361508656484 7978.30257287788,103.672365492664 7977.16651815034,58.1441045491001 PathPoint;PointKind.CORNERPOINT 7980.42643856639,149.268689773878 7980.42643856639,149.268689773878 7980.42643856639,149.268689773878 PathPoint;PointKind.SMOOTHPOINT 7980.46021865627,196.090883506795 7981.66735674671,218.191810421571 7979.6424952263,181.119567544435 PathPoint;PointKind.SMOOTHPOINT 7980.52214882105,281.931572017143 7981.43676761911,296.877907817041 7978.47458286655,248.471065417819 PathPoint;PointKind.CORNERPOINT 7980.60674066656,399.183355311964 7980.60674066656,399.183355311964 7980.60674066656,399.183355311964 PathPoint;PointKind.CORNERPOINT 7983.53408478877,643.697271240891 7983.53408478877,643.697271240891 7983.53408478877,643.697271240891 PathPoint;PointKind.SMOOTHPOINT 7983.59601495355,729.537959751239 7983.12484566711,745.970396422987 7984.06718423999,713.105523079491 PathPoint;PointKind.SMOOTHPOINT 7986.41451211948,823.180362540764 7986.02949914183,840.738515921747 7986.79952509713,805.622209159781 PathPoint;PointKind.CORNERPOINT 7983.52278002283,973.250339266358 7983.52278002283,973.250339266358 7983.52278002283,973.250339266358 PathPoint;PointKind.SMOOTHPOINT 7986.3581672337,1090.30383892234 7986.84330986458,1116.69279387662 7985.79932978177,1059.90631166516 PathPoint;PointKind.SMOOTHPOINT 7986.45012414505,1217.76425519528 7987.12217280375,1250.91379230114 7985.77807548635,1184.61471808943 PathPoint;PointKind.SMOOTHPOINT 7986.52519101145,1321.81357460177 7987.85745318061,1350.71276175724 7985.50236971065,1299.62672213165 PathPoint;PointKind.SMOOTHPOINT 7989.3849749539,1472.68310306486 7989.1074489427,1500.650861612 7989.6625009651,1444.71534451771 PathPoint;PointKind.CORNERPOINT 7992.43617940568,1888.87839601448 7992.43617940568,1888.87839601448 7992.43617940568,1888.87839601448 PathPoint;PointKind.SMOOTHPOINT 7995.35789351291,2125.58861298792 7995.7656730403,2151.57039315034 7994.95011398551,2099.6068328255 PathPoint;PointKind.SMOOTHPOINT 7995.53242397729,2367.50328060799 7995.00225610808,2383.71252224112 7996.06259184651,2351.29403897487 PathPoint;PointKind.SMOOTHPOINT 7994.7640156929,2639.50862031432 7995.61667180294,2685.98206539712 7993.91135958285,2593.03517523152 PathPoint;PointKind.SMOOTHPOINT 7991.2063386755,2951.18906221231 7992.65310453912,3010.23667213154 7989.885854767,2897.29546360391 PathPoint;PointKind.SMOOTHPOINT 7991.48971609617,3343.97524297178 7992.29705719013,3485.92889571062 7990.68237500222,3202.02159023294 PathPoint;PointKind.CORNERPOINT 7994.88998147673,4243.99987116155 7994.88998147673,4243.99987116155 7994.88998147673,4243.99987116155 PathPoint;PointKind.SMOOTHPOINT 7995.15834552412,4615.97618803973 7994.16803441067,4691.09447571568 7996.14865663757,4540.85790036377 PathPoint;PointKind.CORNERPOINT 7995.285959197,4792.86003103075 7995.285959197,4792.86003103075 7995.285959197,4792.86003103075 PathPoint;PointKind.SMOOTHPOINT 7995.35351937677,4886.50441849658 7993.72254295619,4906.28508133633 7997.73209448869,4857.65679584882 PathPoint;PointKind.SMOOTHPOINT 7995.45485964641,5026.97099969534 7994.36484158609,5043.31620221971 7996.54487770673,5010.62579717096 PathPoint;PointKind.SMOOTHPOINT 7992.76893871352,5418.51078290215 7992.65882053094,5442.35640241227 7992.8790568961,5394.66516339203 PathPoint;PointKind.SMOOTHPOINT 7990.9543530335,5675.51215892728 7990.42657933187,5719.55527606327 7991.34510805104,5642.90335527555 PathPoint;PointKind.SMOOTHPOINT 7986.32568263514,5888.78985341883 7985.97211039327,5912.42366853273 7986.57510025344,5872.1180416107 PathPoint;PointKind.SMOOTHPOINT 7976.1308984975,5969.22683731612 7971.72043906492,5977.01780026157 7980.01175685945,5962.37140101595 PathPoint;PointKind.SMOOTHPOINT 7962.38184358166,5977.04045965315 7961.32171379389,5977.52013121183 7964.02950564137,5976.29495034149 PathPoint;PointKind.SMOOTHPOINT 7835.83686554645,5974.53052177822 7824.19286677823,5974.62993867167 7847.48086431466,5974.43110488476 PathPoint;PointKind.SMOOTHPOINT 7692.2969446527,5984.23531548394 7671.50282889736,5985.79233480172 7713.09106040804,5982.67829616616 PathPoint;PointKind.SMOOTHPOINT 7436.46168161111,5987.02112336587 7426.34294516422,5986.221201119 7446.58041805799,5987.82104561274 PathPoint;PointKind.SMOOTHPOINT 7287.91108435825,5987.12829588657 6319.74670112075,5998.16079151115 7304.81873079287,5986.93562867164 PathPoint;PointKind.CORNERPOINT 4287.63883664315,5989.29902459457 4287.63883664315,5989.29902459457 4287.63883664315,5989.29902459457 PathPoint;PointKind.CORNERPOINT 3044.21907224031,5995.3985642567 3044.21907224031,5995.3985642567 3044.21907224031,5995.3985642567 PathPoint;PointKind.CORNERPOINT 625.132041719108,5978.54258736585 625.132041719108,5978.54258736585 625.132041719108,5978.54258736585 PathPoint;PointKind.SMOOTHPOINT 72.6986146625468,5983.14361145433 67.0546685123782,5983.24752689493 93.6601832027827,5981.14504744946 PathPoint;PointKind.SMOOTHPOINT 56.4376144801045,5982.14734140317 52.6892246929565,5981.08982691802 61.7190135840192,5983.63735614855 PathPoint;PointKind.SMOOTHPOINT 44.1706932052293,5978.24548032808 41.7979628091716,5977.15420961477 49.5735246231425,5980.73036091338 PathPoint;PointKind.SMOOTHPOINT 36.1663665603792,5972.25125352535 34.2819147754672,5969.29150265489 37.5971448927066,5974.49845743285 PathPoint;PointKind.SMOOTHPOINT 32.1555457842815,5957.25414324696 30.6051775490023,5949.73366430909 32.9836774224968,5961.27121893341 PathPoint;PointKind.SMOOTHPOINT 28.646089450719,5931.15070657204 28.4092890473694,5902.43867819575 28.7281946134553,5941.10595043545 PathPoint;PointKind.CORNERPOINT 28.5495519564429,5452.11872307198 28.5495519564429,5452.11872307198 28.5495519564429,5452.11872307198 PathPoint;PointKind.SMOOTHPOINT 24.4941203730623,5375.28708634632 24.1828012775786,5346.59814390756 24.7899499438699,5402.5486249146 PathPoint;PointKind.SMOOTHPOINT 24.4265601933002,5281.64269888049 24.0853766656519,5255.38203656283 24.7677437209468,5307.90336119815 PathPoint;PointKind.SMOOTHPOINT 18.8158392646874,5130.77515509371 16.8445979778553,5107.15323598248 20.7870805515186,5154.39707420494 PathPoint;PointKind.CORNERPOINT 4.9587413328909,4293.18769517281 4.9587413328909,4293.18769517281 4.9587413328909,4293.18769517281 PathPoint;PointKind.SMOOTHPOINT 12.7846425492316,4051.86848942261 13.880840012358,4029.23162514949 11.6884450861035,4074.50535369574 PathPoint;PointKind.SMOOTHPOINT 12.7264657277692,3971.23026688259 12.1013014937589,3946.3705519722 13.3516299617777,3996.08998179298 PathPoint;PointKind.SMOOTHPOINT 9.88920184524068,3851.57553424144 8.80290746217452,3834.05955337941 11.1354662540552,3871.67095577185 PathPoint;PointKind.SMOOTHPOINT 9.74469812741427,3651.28059438396 9.30889742555337,3630.32450252136 10.1804988292752,3672.23668624657 PathPoint;PointKind.SMOOTHPOINT 9.63022115614967,3492.60538228908 11.2725470831729,3472.79491578011 7.98789522912648,3512.41584879804 PathPoint;PointKind.CORNERPOINT 6.75354716875972,3318.32475695953 6.75354716875972,3318.32475695953 6.75354716875972,3318.32475695953 PathPoint;PointKind.CORNERPOINT 14.2006484015219,2551.95525444069 14.2006484015219,2551.95525444069 14.2006484015219,2551.95525444069 PathPoint;PointKind.CORNERPOINT 8.24274321579378,1919.85960839892 8.24274321579378,1919.85960839892 8.24274321579378,1919.85960839892 PathPoint;PointKind.CORNERPOINT 10.652125959823,1446.43322042311 10.652125959823,1446.43322042311 10.652125959823,1446.43322042311 PathPoint;PointKind.CORNERPOINT 14.0244490589339,576.41605054977 14.0244490589339,576.41605054977 14.0244490589339,576.41605054977 PathPoint;PointKind.SMOOTHPOINT 13.9456288492102,467.164265172963 13.4598833286964,436.55240971902 14.4313743697239,497.776120626905 PathPoint;PointKind.SMOOTHPOINT 17.5621711202284,280.878952159302 17.1041835014812,228.744931150221 18.0201587389756,333.012973168383 PathPoint;PointKind.SMOOTHPOINT 21.1827544263242,100.194871350057 21.4889477806955,74.6989404909846 20.8765610719547,125.69080220913 PathPoint;PointKind.SMOOTHPOINT 21.150851008103,55.9739106023017 22.3385574030708,43.97359768354 19.0220463113956,77.4828648452531 PathPoint;PointKind.SMOOTHPOINT 23.8809290745266,32.2585710361045 24.9428964284343,29.3037692733606 22.0176622751769,37.4428961501735 PathPoint;PointKind.SMOOTHPOINT 25.8744354637756,23.2571304693938 26.6263369275866,22.4822051603051 23.4984340416258,25.7058870220471 PathPoint;PointKind.SMOOTHPOINT 31.8729909933409,21.252802263054 34.8289692206517,20.5513893537081 30.7139691877337,21.5278221698836 PathPoint;PointKind.SMOOTHPOINT 40.8729886511055,21.2463091727996 45.6105637850887,20.6387945891129 37.6391829836302,21.6609905336736 PathPoint;PointKind.SMOOTHPOINT 53.872985267878,21.2369302646548 55.9854667283589,21.2729982063001 48.3413749279907,21.1424850339245 PathPoint;PointKind.SMOOTHPOINT 59.8729837063884,21.2326015378185 62.102989141089,21.2629780464476 57.4219099710854,21.1992136987965 PathPoint;PointKind.SMOOTHPOINT 66.5837380045723,22.0931822845914 68.9957750864887,22.4418138633464 64.6435263264157,21.8127475161764 PathPoint;PointKind.SMOOTHPOINT 73.4174254286045,22.1163146700565 78.2046483696349,21.1422315355694 71.3206557793592,22.5429561650089 PathPoint;PointKind.SMOOTHPOINT 85.8729769399315,21.2138437215281 87.7992874142346,21.0716957025725 82.0974168830971,21.4924532134501 PathPoint;PointKind.SMOOTHPOINT 91.8729753784419,21.2095149946917 97.4069283217823,21.4504039692574 89.9873052357252,21.1274331353598 PathPoint;PointKind.SMOOTHPOINT 109.156437833773,22.0943721532976 118.428801106328,22.8060825360872 102.696421928839,21.5985265681556 PathPoint;PointKind.SMOOTHPOINT 147.66955564007,22.0665866849677 170.873716716895,21.3391120403976 137.931068259439,22.3718984186007 PathPoint;PointKind.SMOOTHPOINT 459.778535548598,22.2401806484913 507.202335410794,23.6494410142277 412.354735686403,20.8309202827559 PathPoint;PointKind.SMOOTHPOINT 778.883472600312,16.8074922262895 829.522080221835,15.8851918601295 728.244864978787,17.7297925924495 PathPoint;PointKind.SMOOTHPOINT 875.166267116054,16.7380285554646 911.432424903008,16.3373540118255 839.067657443138,17.1368519996695 PathPoint;PointKind.SMOOTHPOINT 943.939691770155,16.6884116477322 964.673061639543,17.243158122229 924.426951574233,16.1663246016005 PathPoint;PointKind.SMOOTHPOINT 1001.7093684796,16.6467334452364 946.688645182323,17.0483508599027 977.056546311045,16.8266838731888 PathPoint;PointKind.SMOOTHPOINT 1425.35366434887,16.3410932936058 1484.0334440563,16.3879126876936 1272.19420745731,16.218890500646 PathPoint;PointKind.CORNERPOINT 1848.99796021814,16.0354531419744 1848.99796021814,16.0354531419744 1848.99796021814,16.0354531419744 PathPoint;PointKind.SMOOTHPOINT 1926.02231915907,13.3786492201525 1959.56352990456,12.4794061018501 1891.83064700164,14.2953312720956 PathPoint;PointKind.CORNERPOINT 2421.18909999694,10.4201744993179 2421.18909999694,10.4201744993179 2421.18909999694,10.4201744993179 PathPoint;PointKind.SMOOTHPOINT 2591.74719313912,10.297124568142 2611.60693862447,10.3342300439963 2568.71844569365,10.2540982044384 PathPoint;PointKind.SMOOTHPOINT 2759.55434929513,10.1760593132749 2781.70930044704,10.0704312288526 2720.14225605574,10.3639642146845 PathPoint;PointKind.SMOOTHPOINT 3128.17802876945,7.30887970266758 3160.52795920516,7.63068580630807 3094.26594907121,6.97153386955324 PathPoint;PointKind.SMOOTHPOINT 3396.77634676403,16.1151005365946 3432.76971898106,16.365907790725 3343.64813650985,15.7448951429369 PathPoint;PointKind.SMOOTHPOINT 3669.11723172262,13.3173845968131 3714.82798998082,13.2505129459087 3622.54565983104,13.3855155580186 PathPoint;PointKind.SMOOTHPOINT 3911.19968650505,13.142733081595 3947.18453954742,13.1573107542936 3874.45991502745,13.1278495870602 PathPoint;PointKind.CORNERPOINT 4466.8889577102,12.7418284671176 4466.8889577102,12.7418284671176 4466.8889577102,12.7418284671176 PathPoint;PointKind.SMOOTHPOINT 4700.71484819082,7.37066501050322 4750.42965229058,8.14019539175752 4649.58005353519,6.57915474028778 PathPoint;PointKind.CORNERPOINT 5138.11570566257,9.6563344624883 5138.11570566257,9.6563344624883 5138.11570566257,9.6563344624883 PathPoint;PointKind.CORNERPOINT 6161.46238784395,6.31680189026883 6161.46238784395,6.31680189026883 6161.46238784395,6.31680189026883 PathPoint;PointKind.SMOOTHPOINT 6552.09543987925,6.03497785434956 6605.51499267232,5.69529577622507 6498.67588708617,6.37465993247406 PathPoint;PointKind.SMOOTHPOINT 7190.31282066931,5.57453295059349 7268.56105096054,6.40900732741102 7112.06459037809,4.74005857377688 PathPoint";

// Build the path

function createPath(thisFrame) {
	
	var thisPathPointInfo = thisFrame.split(";");
	var thisPathPointInfoProperties = [];
	
	var p = [];
	var pth = [];
	
	for (var i = 0; i < thisPathPointInfo.length; i++ ) {
		
		thisPathPointInfoProperties = thisPathPointInfo[i].split(" "); // Splitta thisPathPointInfo i dess properties
		
		p[i] = new PathPointInfo();
		p[i].kind = thisPathPointInfoProperties[0];
	
		var anchorString = thisPathPointInfoProperties[1].split(",");
		p[i].anchor = [anchorString[0]*1, anchorString[1]*1];
		
		var leftDirectionString = thisPathPointInfoProperties[2].split(",");
		p[i].leftDirection = [leftDirectionString[0]*1, leftDirectionString[1]*1];
		
		var rightDirectionString = thisPathPointInfoProperties[3].split(",");
		p[i].rightDirection = [rightDirectionString[0]*1, rightDirectionString[1]*1];

		p[i].typename = thisPathPointInfoProperties[4];
	
	}

	pth[0] = new SubPathInfo();
	pth[0].operation = ShapeOperation.SHAPEXOR;
	pth[0].closed = true;
	pth[0].entireSubPath = p;
	
	app.activeDocument.pathItems.add("Frame", pth);
	
}

function biggerCanvas() {
	
	if ( ratio > 1 ) {
			
			var new_doc_height = doc_height * borderThickness / ratio / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness / 100 + doc_width;
	
			var offset = offset_factor * borderThickness / 100 * doc_width / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(offset + doc_width,"px"), UnitValue(doc_height,"px"), AnchorPosition.MIDDLERIGHT);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
			
		} else {
			
			var new_doc_height = doc_height * borderThickness / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness * ratio / 100 + doc_width;
			
			var offset = offset_factor * borderThickness / 100 * doc_height / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(doc_width,"px"), UnitValue(offset + doc_height,"px"), AnchorPosition.TOPCENTER);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
		}

}


// Generate a number between 0 and max, including max
function generateRandomInteger(max) {
    return Math.floor(Math.random() * max) + 1;
}

function format(){
	
	if (doc_height > doc_width) {
		if (doc_height/doc_width < 1.1) {
			var format = "square";
		}
		else if (doc_height/doc_width > 1.1 && doc_height/doc_width < 1.2) {
			var format = "67";
		}
		else if (doc_height/doc_width > 1.2 && doc_height/doc_width < 1.4) {
			var format = "645";
		}
		else if (doc_height/doc_width > 1.4) {
			var format = "35mm";
		}
	}
	else {
		if (doc_width/doc_height < 1.1) {
			var format = "square";
		}
		else if (doc_width/doc_height > 1.1 && doc_width/doc_height < 1.2) {
			var format = "67";
		}
		else if (doc_width/doc_height > 1.2 && doc_width/doc_height < 1.4) {
			var format = "645";
		}
		else if (doc_width/doc_height > 1.4) {
			var format = "35mm";
		}
	}

	return format;
}


// LET'S GET THIS SHOW GOING!!!!

app.activeDocument.resizeImage(null, null, 72, ResampleMethod.NONE); // Necessary to resample to 72dpi for the frame to fit


// Choosing the frame

var thisFormat = format();

if (thisFormat == "square") {
	
} 
else if (thisFormat == "67") {
	
} 
else if (thisFormat == "645") {
	var useFrame = frame645[generateRandomInteger(frame645.length) - 1];
}
else if (thisFormat == "35mm") {
	var useFrame = frame35mm[generateRandomInteger(frame35mm.length) - 1];
}

//var useFrame = frame645[1]; // this sets the used frame. Change for logic.

// Drawing path

if (ratio > 1 ){
	// For portrait we need to rotate before placing path. We also add some random flipping to simulate holding the camera in opposite way.
	
	if (generateRandomInteger(10) < 7) {
		
		app.activeDocument.rotateCanvas(-90);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(90);
		
	} else {
		
		app.activeDocument.rotateCanvas(-270);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(270);
		
	}
	
} else {
	if (generateRandomInteger(10) < 7) {
		
		createPath(useFrame);
		
	} else {
		
		app.activeDocument.rotateCanvas(-180);
		createPath(useFrame);
		app.activeDocument.rotateCanvas(180);
		
	}
}

biggerCanvas(); // Enlarge canvas

app.activeDocument.pathItems.getByName('Frame').makeSelection(feather, true); // Make selection from path

app.activeDocument.pathItems.getByName('Frame').remove(); // Trash path

app.activeDocument.selection.invert(); // Invert selection

var myColor = new SolidColor();  
myColor.rgb.red = 0;  
myColor.rgb.green = 0;  
myColor.rgb.blue = 0;  

app.activeDocument.selection.fill(myColor); // Fill with black

app.activeDocument.selection.deselect(); // Unnecessary?

//app.activeDocument.save();

//app.activeDocument.close();
