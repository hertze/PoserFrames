#target photoshop

// Settings

var borderThickness = 4;


app.preferences.rulerUnits = Units.PIXELS;
app.displayDialogs.NO;


// Initial

var doc_height = app.activeDocument.height;
var doc_width = app.activeDocument.width;
var ratio = doc_height / doc_width;

if (ratio > 1) {
	var feather = doc_width / 1200;
} else {
	var feather = doc_height / 1200;
}

// Frames

var frame = [];

frame[1] = "PointKind.CORNERPOINT 10,36 10,36 10,36 PathPoint;PointKind.SMOOTHPOINT 10.170283672805,31.0470569698894 11.2540813176504,26.2788794414753 9.52105658812071,33.9033373934099 PathPoint;PointKind.SMOOTHPOINT 18.5759646977006,16.5447663442753 22.2713671597052,13.9569236418135 12.6620579898118,20.6861989688419 PathPoint;PointKind.SMOOTHPOINT 35,12 42.023642823877,11.0532015001705 29.6869000846633,12.7162145279062 PathPoint;PointKind.SMOOTHPOINT 57.1680673335252,11.6439687058437 59.4808034734315,11.6105050226961 49.4984999047528,11.754942011396 PathPoint;PointKind.SMOOTHPOINT 64.174512433331,11.5456263582077 67.0235053516582,10.8280188033227 61.8881140792879,12.1215269586561 PathPoint;PointKind.SMOOTHPOINT 69.4656750929525,11.475166681997 132.334924551752,10.6563998639688 67.6906112665326,11.4982839193342 PathPoint;PointKind.SMOOTHPOINT 273.122937564769,10.1792086470092 290.647187445139,10.1417882337579 217.106980280759,10.2988223414351 PathPoint;PointKind.SMOOTHPOINT 324,10 337.510565153717,9.97196995235051 306.498198512012,10.0363105705852 PathPoint;PointKind.SMOOTHPOINT 366.173113390772,9.98550917867583 391.522977062455,9.93409256488726 352.676581901851,10.0128839194649 PathPoint;PointKind.SMOOTHPOINT 442,9 582.627291098396,8.72687975528027 416.702548342515,9.04913161686833 PathPoint;PointKind.SMOOTHPOINT 859.184120778175,4.11743469036532 871.231093885475,4.09952760255337 720.560522155707,4.32349018092152 PathPoint;PointKind.SMOOTHPOINT 890,6 894.864269094842,5.99295369705734 877.970831421137,6.01742526252195 PathPoint;PointKind.SMOOTHPOINT 907.21157576914,6.74098542393773 932.14247766449,6.20509820639519 900.143360695246,6.89291599286945 PathPoint;PointKind.SMOOTHPOINT 984,5 1001.56077565271,4.97576660379909 966.890891314404,5.02361010798282 PathPoint;PointKind.SMOOTHPOINT 1013.89210772595,3.89995053585238 1101.90872495922,3.78326364480133 996.372294416886,3.9231772015786 PathPoint;PointKind.SMOOTHPOINT 1276.28082749127,3.58698399895228 1517.15515870378,3.33130975854738 1189.39996135184,3.67920303841614 PathPoint;PointKind.SMOOTHPOINT 1983.01766466295,3.07630154661655 1989.78601357154,3.07363890775191 1753.33783436604,3.16665658753297 PathPoint;PointKind.SMOOTHPOINT 2003.0286627052,3.06278756590418 2025.79866096523,3.04201210099504 1996.44011367102,3.06879899233024 PathPoint;PointKind.SMOOTHPOINT 2071,3 2075.1647807327,2.25495972359611 2047.55134836719,7.19474421705815 PathPoint;PointKind.SMOOTHPOINT 2083.89064365844,2.99783884394672 2103.17249261077,2.99694847389398 2079.53734340533,2.998039864512 PathPoint;PointKind.SMOOTHPOINT 2142,3 2167.73552870003,2.99355161515304 2123.37351410552,3.00466711800617 PathPoint;PointKind.SMOOTHPOINT 2219,3 2434.11950790793,2.96080724638606 2193.44578357341,3.00465573818918 PathPoint;PointKind.SMOOTHPOINT 2845.01647057769,4.06429395225102 2864.39978652798,4.07120484208303 2644.51744349488,3.99280841844713 PathPoint;PointKind.SMOOTHPOINT 2904,3 2929.07959461718,3.0101665076434 2884.76956018427,2.99220456245976 PathPoint;PointKind.SMOOTHPOINT 2981,4 3314.93080340567,4.15636394675127 2956.18603016522,3.98838079560687 PathPoint;PointKind.SMOOTHPOINT 3901.81759285844,4.90339241367725 3934.44575531477,4.94368703540723 3624.30153223488,4.56066993576305 PathPoint;PointKind.SMOOTHPOINT 4000,4 4023.5194342743,4.03096064633581 3968.27116553866,3.95823261686706 PathPoint;PointKind.SMOOTHPOINT 4068.16096181661,5.1204963135601 4108.83278537804,5.17644766334232 4045.14771089474,5.08883748100222 PathPoint;PointKind.SMOOTHPOINT 4187.75263838089,5.29113899493546 4356.69163114686,5.54088561134524 4148.70609912382,5.23341554754002 PathPoint;PointKind.SMOOTHPOINT 4645.84994022971,6.06167360734698 4664.25593337081,6.09651951768789 4510.15380244818,5.80477600804358 PathPoint;PointKind.SMOOTHPOINT 4700.08159905698,6.16577261794156 4721.85203977353,6.20813921674067 4682.33505730055,6.13123677071387 PathPoint;PointKind.SMOOTHPOINT 4765,5 5020.91192904346,5.51435654902216 4744.24111038836,4.95827677567792 PathPoint;PointKind.SMOOTHPOINT 5314.93874505992,13.3357271176007 5319.09114668457,13.3803790827191 5222.15196530452,12.3379642739281 PathPoint;PointKind.SMOOTHPOINT 5326.75189074649,13.4645297705516 5331.56270210143,12.561073172787 5323.09406442638,14.151459080094 PathPoint;PointKind.SMOOTHPOINT 5337.79909595325,13.5883979057019 5360.12105266333,13.8422704315611 5334.36247551298,13.5493124651682 PathPoint;PointKind.CORNERPOINT 5372,14 5372,14 5372,14 PathPoint;PointKind.SMOOTHPOINT 5386.99925354679,20.3018627889365 5389.62617735979,22.7895286659075 5380.71339507129,14.3492289289198 PathPoint;PointKind.SMOOTHPOINT 5392.39994221556,32.297076468452 5392.75404896652,34.3041186944204 5391.43621137921,26.8347449037724 PathPoint;PointKind.SMOOTHPOINT 5393,39 5393.03719265001,41.6337595769186 5392.96512646561,36.530466230444 PathPoint;PointKind.SMOOTHPOINT 5393.10546519735,46.9807775350082 5393.18712851263,53.5967533942476 5393.07230930668,44.2946439685116 PathPoint;PointKind.SMOOTHPOINT 5393.31649232937,67.2601963843774 5393.3380841953,69.7580545125502 5393.25689699397,60.3659014028765 PathPoint;PointKind.SMOOTHPOINT 5393.37734361173,74.8017209482496 5393.93609570965,78.137823830548 5392.8895906621,71.8895278179929 PathPoint;PointKind.SMOOTHPOINT 5393.44705088914,85.0269423567225 5393.92327559931,162.425246975541 5393.42592625329,81.5936660772562 PathPoint;PointKind.SMOOTHPOINT 5394,317 5394.15313814005,332.566143135543 5393.35977311069,251.92239493917 PathPoint;PointKind.SMOOTHPOINT 5394,368 5394.14407450734,383.217572083581 5393.85280025162,352.452330790633 PathPoint;PointKind.SMOOTHPOINT 5392.68440086091,413.858899357353 5393.55694086647,509.62591359845 5392.545934532,398.661307489372 PathPoint;PointKind.SMOOTHPOINT 5393.98035356098,697.620134967417 5394.19837075494,728.817171861864 5393.31892780991,602.973822057585 PathPoint;PointKind.SMOOTHPOINT 5397,785 5397.13358010061,806.094602588875 5396.80347639883,753.9655326864 PathPoint;PointKind.SMOOTHPOINT 5394.98819101932,854.133405525704 5396.33465018258,1082.42271792715 5394.86426354256,833.121763117054 PathPoint;PointKind.SMOOTHPOINT 5393.48240915545,1520.67448527614 5393.63095942693,1607.93353179477 5393.11801519421,1306.62795881544 PathPoint;PointKind.SMOOTHPOINT 5392,1769 5392.00592882918,1795.11414393102 5391.98094293553,1685.06118015701 PathPoint;PointKind.SMOOTHPOINT 5393.72963586753,1855.42131111837 5393.65718684548,2203.21613932007 5393.73500145584,1829.66356020256 PathPoint;PointKind.SMOOTHPOINT 5392.2277382381,2779.60348168344 5392.07192643685,2809.61483914772 5393.58195085738,2518.76470905759 PathPoint;PointKind.SMOOTHPOINT 5390,2866 5389.81490344502,2898.61048270668 5390.16209559876,2837.44184708927 PathPoint;PointKind.SMOOTHPOINT 5390,2967 5389.74711243295,3007.72096559144 5390.19021112603,2936.37144515052 PathPoint;PointKind.SMOOTHPOINT 5390.42253013289,3079.03100469279 5388.9935314806,3286.38776430369 5390.67769901363,3042.00438316442 PathPoint;PointKind.SMOOTHPOINT 5389.75957922045,3509.34946491506 5389.6754684602,3514.73134413004 5390.87906518195,3437.71846063713 PathPoint;PointKind.SMOOTHPOINT 5390.52480973209,3530.11755845057 5390.29210035533,3533.23613495809 5390.85166188809,3525.73735912499 PathPoint;PointKind.SMOOTHPOINT 5390.38260447506,3538.80648936633 5390.14097723071,3553.39679209186 5390.42673128844,3536.1419571972 PathPoint;PointKind.CORNERPOINT 5390,3561 5390,3561 5390,3561 PathPoint;PointKind.SMOOTHPOINT 5390.03726826051,3563.0383782373 5389.91217887365,3569.45970442485 5390.06210306048,3561.76351107743 PathPoint;PointKind.SMOOTHPOINT 5364,3589 5320.25097122963,3589.27066226776 5387.5814803964,3588.85410837359 PathPoint;PointKind.SMOOTHPOINT 5214.0148500136,3589.50205927216 5210.92711723231,3589.50858502113 5264.81223921478,3589.39470185695 PathPoint;PointKind.SMOOTHPOINT 5204.74909802234,3589.52148078839 5199.8539805719,3589.99401518466 5208.11774676706,3589.19629913199 PathPoint;PointKind.SMOOTHPOINT 5190.0019879213,3589.55207082804 5140.99223988197,3589.65377894537 5194.91362078541,3589.54187789803 PathPoint;PointKind.SMOOTHPOINT 5050.46065923617,3589.98480492049 5039.39012432788,3590.04415153099 5092.57821553685,3589.7590223156 PathPoint;PointKind.SMOOTHPOINT 5035.03442345482,3588.11840951359 5033.74107042032,3588.1335937739 5041.5940615899,3588.04139786219 PathPoint;PointKind.SMOOTHPOINT 5030,3588 5008.48085040853,3588.11291984281 5032.11841100255,3587.98888382478 PathPoint;PointKind.SMOOTHPOINT 4890,3589 4853.59039894928,3589.18439828532 4911.49505742744,3588.8911371831 PathPoint;PointKind.SMOOTHPOINT 4836,3589 4830.72856615621,3589.1319613151 4858.19988504949,3588.44426391129 PathPoint;PointKind.SMOOTHPOINT 4811.39461297814,3591.1855191919 4562.36521066078,3592.35343109093 4820.01635602624,3591.1450844633 PathPoint;PointKind.SMOOTHPOINT 4072.77375238875,3591.27216544369 4032.09522185443,3591.17463515945 4315.70069563807,3591.85460373521 PathPoint;PointKind.SMOOTHPOINT 3951.15252232324,3591.26050738082 3922.86233513269,3591.33167699276 3991.54953317889,3591.15888063772 PathPoint;PointKind.SMOOTHPOINT 3862,3590 3813.60040204111,3590.11221998234 3890.16112371073,3589.9347052261 PathPoint;PointKind.SMOOTHPOINT 3721.87933881304,3591.77643707856 3700.69494507711,3591.81855090699 3769.87030807154,3591.68103272236 PathPoint;PointKind.SMOOTHPOINT 3658.44909746991,3591.90408814447 3642.55210730053,3588.96438815088 3679.1992515246,3595.74124392627 PathPoint;PointKind.SMOOTHPOINT 3615.69126926193,3591.99170915598 3601.41265147532,3592.02115630902 3629.92433735746,3591.96235594122 PathPoint;PointKind.SMOOTHPOINT 3572.91538661767,3592.08042682169 3293.95170732289,3592.66206307971 3587.15386184057,3592.05073975465 PathPoint;PointKind.SMOOTHPOINT 2763.07474388879,3593.69895573136 2740.99425172649,3593.73427966786 3022.78583732864,3593.28347503888 PathPoint;PointKind.SMOOTHPOINT 2697.08391065014,3593.80031094021 2683.98993085224,3595.97529156475 2722.81687068813,3589.52592757027 PathPoint;PointKind.SMOOTHPOINT 2657.35790260158,3593.85697965185 2395.48243982353,3594.21906510116 2670.56836709143,3593.8387140346 PathPoint;PointKind.SMOOTHPOINT 1912.99901889075,3593.93303925392 1873.43284029,3593.86538457269 2146.06579932343,3594.33156292476 PathPoint;PointKind.SMOOTHPOINT 1795.71575604845,3593.71931718813 1753.88847442325,3593.63839824899 1834.33234645637,3593.79402473325 PathPoint;PointKind.SMOOTHPOINT 1671.96020642136,3593.46523203245 1636.11005936817,3593.38737667653 1712.62890748026,3593.5535517872 PathPoint;PointKind.SMOOTHPOINT 1565.80305994913,3593.22388011649 1364.1244864281,3592.74479698158 1600.71905766991,3593.30682232178 PathPoint;PointKind.SMOOTHPOINT 1011.36674288918,3591.15136049848 1002.70205698336,3591.1091576961 1178.29367179418,3591.96440603397 PathPoint;PointKind.SMOOTHPOINT 984,3590 969.163012662973,3592.89387411796 992.404131532805,3588.36081960749 PathPoint;PointKind.SMOOTHPOINT 940.585102646911,3590.79963292275 782.31809760054,3589.99876008194 955.403180307936,3590.87461630889 PathPoint;PointKind.SMOOTHPOINT 524.440840408577,3588.66733829629 491.162923625687,3588.5163609557 642.643365136135,3589.20360692604 PathPoint;PointKind.SMOOTHPOINT 423,3586 400.038782135179,3585.89027789175 452.809841205035,3586.14244883015 PathPoint;PointKind.SMOOTHPOINT 364.06636401182,3587.90669047255 252.771563597136,3587.35471794001 384.902494887225,3588.01002838128 PathPoint;PointKind.SMOOTHPOINT 75.6029135111268,3586.2102989509 65.5859579326959,3585.98167100727 121.219531353338,3587.2514569605 PathPoint;PointKind.SMOOTHPOINT 59.0569435701094,3586.15352563461 60.7631935701094,3586.29102563461 58.7284358661381,3586.12705248631 PathPoint;PointKind.SMOOTHPOINT 56.0188373843679,3586.13358411797 43.0757251965783,3586.0484780851 56.9981255766075,3586.14002332145 PathPoint;PointKind.CORNERPOINT 36,3586 36,3586 36,3586 PathPoint;PointKind.SMOOTHPOINT 14,3557 13.9126086454025,3549.87529422611 14.3581822787307,3586.20132501816 PathPoint;PointKind.SMOOTHPOINT 13.7613979459782,3535.51950957958 14.1188941596958,3531.83259244007 13.0670250720928,3542.68069101788 PathPoint;PointKind.SMOOTHPOINT 13.662425895482,3525.08297271687 13.6218192088842,3520.56228872929 13.6937409755951,3528.56923552476 PathPoint;PointKind.SMOOTHPOINT 13.5487686139103,3511.48508455784 13.0912632531061,3452.45413129744 13.583987956534,3516.02936216942 PathPoint;PointKind.SMOOTHPOINT 13.1400402375445,3329.1562328066 13.1505620476236,3319.25176940812 13.0745035539813,3390.84767930941 PathPoint;PointKind.SMOOTHPOINT 13.1764860737118,3299.44657656789 10.4691279896708,3288.97869411606 16.1710176120351,3311.02480270881 PathPoint;PointKind.SMOOTHPOINT 13.2203570927767,3267.05211515876 13.3108458749145,3197.85312111723 13.2062611470231,3277.83163106309 PathPoint;PointKind.SMOOTHPOINT 12.8354772419437,3065.86631305497 12.5592916661576,3031.85209700635 13.3530307540653,3129.60670546295 PathPoint;PointKind.SMOOTHPOINT 12,2967 11.8335731570887,2944.1298775646 12.2458619677067,3000.78597589968 PathPoint;PointKind.SMOOTHPOINT 11,2892 10.9229040576684,2880.52780458788 11.1529362342368,2914.75754484213 PathPoint;PointKind.SMOOTHPOINT 11.3474772228684,2861.34567757342 9.32067114910792,2546.80033155173 11.4212072316854,2872.78803085811 PathPoint;PointKind.SMOOTHPOINT 4.62478301027623,1961.59396462241 4.63468933935014,1919.75736800336 4.55775055346345,2244.68670615507 PathPoint;PointKind.SMOOTHPOINT 2,1840 2.02074907979544,1821.02363655963 1.95524167555655,1880.93435660738 PathPoint;PointKind.SMOOTHPOINT 4.78037138631721,1780.79712792325 5.59105774380053,1233.29889809496 4.7525729037329,1799.5708742264 PathPoint;PointKind.SMOOTHPOINT 8.61959664479233,467.823613719031 8.69354125185166,459.650239504449 5.86529178407134,772.267240144043 PathPoint;PointKind.SMOOTHPOINT 8.84685142278663,443.643433790264 10.3151397146857,433.869193715496 7.66634614895735,451.501932710128 PathPoint;PointKind.SMOOTHPOINT 9.13482546135429,415.474813783623 9.17697795951189,411.537093088799 9.03609722838226,424.697617250305 PathPoint;PointKind.SMOOTHPOINT 9.26280608231339,403.753448856326 9.65722036709749,368.337365940067 9.21963553332244,407.629910236118 PathPoint;PointKind.SMOOTHPOINT 9,313 9.22325009994407,294.436368726001 8.63707075188693,343.178193614285 PathPoint;PointKind.SMOOTHPOINT 9,253 8.40938894359773,178.28762366663 9.13042551810522,269.498845198581 PathPoint;PointKind.SMOOTHPOINT 9,67 8.91197516855271,61.3405230232647 9.61224244762615,106.363574795316 PathPoint;PointKind.SMOOTHPOINT 10,52 10.8272032255383,38.1612343415949 9.63150315686147,58.1647988071341 PathPoint";



function setOrientation(){
	
	
	
}


// Build the path

function createPath(thisFrame) {
	
	var thisPathPointInfo = thisFrame.split(";");
	var thisPathPointInfoProperties = [];
	
	var p = [];
	var pth = [];
	
	for (var i = 0; i < thisPathPointInfo.length; i++ ) {
		
		thisPathPointInfoProperties = thisPathPointInfo[i].split(" "); // Splitta thisPathPointInfo i dess properties
		
		p[i] = new PathPointInfo();
		p[i].kind = thisPathPointInfoProperties[0];
	
		var anchorString = thisPathPointInfoProperties[1].split(",");
		p[i].anchor = [anchorString[0]*1, anchorString[1]*1];
		
		var leftDirectionString = thisPathPointInfoProperties[2].split(",");
		p[i].leftDirection = [leftDirectionString[0]*1, leftDirectionString[1]*1];
		
		var rightDirectionString = thisPathPointInfoProperties[3].split(",");
		p[i].rightDirection = [rightDirectionString[0]*1, rightDirectionString[1]*1];

		p[i].typename = thisPathPointInfoProperties[4];
	
	}

	pth[0] = new SubPathInfo();
	pth[0].operation = ShapeOperation.SHAPEXOR;
	pth[0].closed = true;
	pth[0].entireSubPath = p;
	
	app.activeDocument.pathItems.add("Frame", pth);
	
}

function biggerCanvas() {
	
	if ( ratio > 1 ) {
			
			var new_doc_height = doc_height * borderThickness / ratio / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness / 100 + doc_width;
	
			var offset = borderThickness / 100 * doc_width / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(offset + doc_width,"px"), UnitValue(doc_height,"px"), AnchorPosition.MIDDLERIGHT);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
			
		} else {
			
			var new_doc_height = doc_height * borderThickness / 100 + doc_height;
			var new_doc_width = doc_width * borderThickness * ratio / 100 + doc_width;
			
			var offset = borderThickness / 100 * doc_height / generateRandomInteger(10);
			
			// Offset
			app.activeDocument.resizeCanvas(UnitValue(doc_width,"px"), UnitValue(offset + doc_height,"px"), AnchorPosition.TOPCENTER);
			
			// Enlarging canvas
			app.activeDocument.resizeCanvas(UnitValue(new_doc_width,"px"), UnitValue(new_doc_height,"px"), AnchorPosition.MIDDLECENTER);
		}

}


// Generate a number between 0 and max, including max
function generateRandomInteger(max) {
    return Math.floor(Math.random() * max) + 1;
}

if (doc_height > doc_width) {
	var orientation = "portrait";
	
	if (doc_height/doc_width > 1.4) {
		var aspect_ratio = "35mm";
	}
	else {
		var aspect_ratio = "645";
	}
}
else {
	var orientation = "landscape"
	
	if (doc_width/doc_height > 1.4) {
		var aspect_ratio = "35mm";
	}
	else {
		var aspect_ratio = "645";
	}
}




// LET'S GET THIS SHOW GOING!!!!

app.activeDocument.resizeImage(null, null, 72, ResampleMethod.NONE); // Necessary to resample to 72dpi for the frame to fit

var useFrame = frame[1]; // this sets the used frame. Change for logic.

// Drawing path

if (ratio > 1 ){
	// For portrait we need to rotate before placing path.
	app.activeDocument.rotateCanvas(-90);
	createPath(useFrame);
	app.activeDocument.rotateCanvas(90);
	
} else {
	createPath(useFrame);
}

//biggerCanvas(); // Enlarge canvas

//app.activeDocument.pathItems.getByName('Frame').makeSelection(feather, true); // Make selection from path

//app.activeDocument.pathItems.getByName('Frame').remove(); // Trash path

//app.activeDocument.selection.invert(); // Invert selection

var myColor = new SolidColor();  
myColor.rgb.red = 0;  
myColor.rgb.green = 0;  
myColor.rgb.blue = 0;  

//app.activeDocument.selection.fill(myColor); // Fill with black

//app.activeDocument.selection.deselect(); // Unnecessary?

//app.activeDocument.save();

//app.activeDocument.close();
